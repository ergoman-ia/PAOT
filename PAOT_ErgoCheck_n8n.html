<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>인간공학 체크포인트(ILO)</title>
    <style>
        /* Basic Reset & Typography */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        /* Container & Layout */
        .container {
            max-width: 1200px;
            margin: auto;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 20px 30px;
        }
        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
        }
        header h1 {
            font-size: 2.25rem;
            color: #1e3a8a;
            font-weight: 700;
        }
        header p {
            color: #555;
            font-size: 1rem;
        }

        /* Buttons */
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: background-color: 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .btn:disabled {
            background-color: #d1d5db;
            cursor: not-allowed;
        }
        .btn-primary { background-color: #2563eb; color: white; }
        .btn-primary:hover:not(:disabled) { background-color: #1d4ed8; }
        .btn-secondary { background-color: #6b7280; color: white; }
        .btn-secondary:hover { background-color: #4b5563; }
        .btn-success { background-color: #16a34a; color: white; }
        .btn-success:hover { background-color: #15803d; }

        /* Navigation & Action Menu */
        nav {
            margin-bottom: 20px;
        }
        .category-nav-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .category-nav-header h2 {
            font-size: 1.25rem;
            font-weight: 600;
            margin: 0;
        }
        .action-menu {
            position: relative; /* Dropdown anchor */
            display: inline-block;
        }
        .btn-menu {
            background: none;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            cursor: pointer;
            padding: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4b5563;
        }
        .btn-menu:hover {
            background-color: #f3f4f6;
        }
        .dropdown-content {
            display: none; /* Hidden by default */
            position: absolute;
            right: 0;
            background-color: #ffffff;
            min-width: 280px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.15);
            z-index: 1;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
            overflow: hidden;
            padding: 6px 0;
        }
        .dropdown-content button {
            color: #374151;
            padding: 10px 16px;
            font-size: 0.9rem;
            text-decoration: none;
            display: block;
            width: 100%;
            text-align: left;
            background: none;
            border: none;
            cursor: pointer;
        }
        .dropdown-content button:hover {
            background-color: #f9fafb;
        }
        .dropdown-divider {
            height: 1px;
            margin: 6px 0;
            background-color: #e5e7eb;
            border: none;
        }
        .show {
            display: block;
        }
        #category-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        #category-buttons a {
            text-decoration: none;
            padding: 6px 12px;
            background-color: #e0e7ff;
            color: #3730a3;
            border-radius: 16px;
            font-size: 0.85rem;
            transition: background-color: 0.3s ease;
        }
        #category-buttons a:hover {
            background-color: #c7d2fe;
        }
        
        /* Table Styling */
        main {
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        .column-header th {
            background-color: #f9fafb;
            font-weight: 600;
            color: #374151;
            text-transform: uppercase;
            font-size: 0.75rem;
        }
        tbody tr:hover {
            background-color: #f9fafb;
        }
        td.center, th.center {
            text-align: center;
        }
        td.category-header {
            background-color: #dbeafe;
            color: #1e40af;
            font-size: 1.25rem;
            font-weight: 700;
        }
        .to-top-btn {
            display: inline-block;
            margin-top: 10px;
            padding: 4px 10px;
            background-color: #e5e7eb;
            color: #4b5563;
            text-decoration: none;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        .to-top-btn:hover {
            background-color: #d1d5db;
        }


        /* Modal Styling */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0; top: 0;
            width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.5);
            overflow-y: auto;
        }
        .modal-content {
            background-color: #fff;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 90%;
            max-width: 800px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            animation: slideIn 0.4s;
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        .modal-header h3 { font-size: 1.5rem; margin: 0; }
        .modal-close {
            font-size: 1.5rem;
            font-weight: bold;
            border: none;
            background: none;
            cursor: pointer;
            color: #aaa;
        }
        .modal-close:hover { color: #333; }
        .modal-body { padding: 20px 0; max-height: 60vh; overflow-y: auto; }
        .modal-footer {
            padding-top: 10px;
            border-top: 1px solid #eee;
            text-align: right;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        /* Report Modal Specifics */
        #report-modal-content h4 {
            font-size: 1.2rem;
            font-weight: 600;
            margin-top: 20px;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #ddd;
            color: #1e3a8a;
        }
        #report-modal-content ul {
            list-style-type: none;
            padding-left: 0;
        }
        #report-modal-content li {
            margin-bottom: 15px;
            padding-left: 10px;
            border-left: 3px solid #e0e7ff;
        }
        #report-modal-content strong {
            display: block;
            color: #111827;
        }
         #report-modal-content .details {
            padding-left: 20px;
            font-size: 0.9rem;
            color: #555;
            list-style-type: disc;
            margin-top: 5px;
        }
        #aiConfigModal .modal-body {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        #aiConfigModal .form-group {
            display: flex;
            flex-direction: column;
        }
        #aiConfigModal label {
            margin-bottom: 5px;
            font-weight: 500;
            color: #374151;
        }
        #aiConfigModal input {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 1rem;
        }
        .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        .error-message {
            color: #dc2626;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        /* Report Modal Table */
        #report-modal-content table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        #report-modal-content th, #report-modal-content td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        #report-modal-content th {
            background-color: #f2f2f2;
            text-align: center;
        }
        #report-modal-content td:first-child, #report-modal-content td:last-child {
            text-align: center;
        }

        /* Toggle Switch */
        .switch { position: relative; display: inline-block; width: 50px; height: 24px; vertical-align: middle; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #2563eb; }
        input:checked + .slider:before { transform: translateX(26px); }

        /* Notification Styling */
        .notification {
            padding: 12px 20px;
            border-radius: 6px;
            color: white;
            font-size: 0.9rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            opacity: 0;
            transform: translateY(-20px);
            animation: fadeInDown 0.5s forwards;
            margin-bottom: 10px;
        }
        .notification.success { background-color: #16a34a; }
        .notification.info { background-color: #2563eb; }
        .notification.fade-out { animation: fadeOutUp 0.5s 3s forwards; }

        @keyframes slideIn {
            from {transform: translateY(-50px); opacity: 0;}
            to {transform: translateY(0); opacity: 1;}
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        @keyframes fadeInDown {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
@keyframes fadeOutUp {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(-20px);
            }
        }

        /* --- [수정 후] 진행바 스타일 시작 --- */
        .progress-item {
            width: 100%;
            margin-bottom: 10px;
        }
        .progress-item label {
            font-size: 0.9rem;
            color: #4b5563;
            margin-bottom: 4px;
            display: block;
        }
        .progress-bar-bg {
            width: 100%;
            height: 10px;
            background-color: #e5e7eb;
            border-radius: 5px;
            overflow: hidden;
        }
        .progress-bar-fg {
            width: 0%;
            height: 100%;
            background-color: #2563eb; /* 진행바 색상 */
            border-radius: 5px;
            transition: width 0.5s ease-out; /* 부드러운 애니메이션 효과 */
        }
    </style>
</head>
<body>
    <div id="notification-area" style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 2000; display: flex; flex-direction: column; gap: 10px; align-items: center;"></div>

    <div class="container">
        <header>
            <h1>인간공학 체크포인트(ILO)</h1>
            <p>작업장의 안전, 보건 및 작업조건 개선</p>
        </header>

        <nav id="category-nav">
            <div class="category-nav-header">
                <h2>카테고리 바로가기</h2>
                <div class="action-menu">
                    <button id="menu-toggle-btn" class="btn-menu" title="메뉴">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 8C13.1 8 14 7.1 14 6C14 4.9 13.1 4 12 4C10.9 4 10 4.9 10 6C10 7.1 10.9 8 12 8ZM12 10C10.9 10 10 10.9 10 12C10 13.1 10.9 14 12 14C13.1 14 14 13.1 14 12C14 10.9 13.1 10 12 10ZM12 16C10.9 16 10 16.9 10 18C10 19.1 10.9 20 12 20C13.1 20 14 19.1 14 18C14 16.9 13.1 16 12 16Z"></path>
                        </svg>
                    </button>
                    <div id="action-dropdown" class="dropdown-content">
                        <button id="manual-btn">사용자 매뉴얼</button>
                        <hr class="dropdown-divider">
                        <button id="load-btn">불러오기</button>
                        <button id="save-btn">저장하기</button>
                        <hr class="dropdown-divider">
                        <button id="generate-btn">체크포인트(인쇄용) 생성</button>
                        <hr class="dropdown-divider">
                        <hr class="dropdown-divider">
                        <button id="ai-config-btn">AI 맞춤 업종&작업별 설문 생성</button>
                    </div>
                    <input type="file" id="csv-file-input" accept=".csv" style="display: none;">
                </div>
            </div>
            <div id="category-buttons"></div>
        </nav>

        <main>
            <table id="main-table">
                <tbody id="checklist-body"></tbody>
            </table>
        </main>
    </div>

    <!-- Report Selection Modal -->
    <div id="selectionReportModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>생성할 보고서 유형 선택</h3>
                <button id="closeSelectionReportModal" class="modal-close">&times;</button>
            </div>
            <div class="modal-body" style="display: flex; flex-direction: column; gap: 15px;">
                <p>어떤 유형의 체크포인트를 생성하시겠습니까?</p>
                <button id="generateWorkerReportBtn" class="btn btn-primary">작업자용 (핵심 20 항목)</button>
                <button id="generateManagerReportBtn" class="btn btn-primary">관리자용 (범주별 50 항목)</button>
                <button id="generateExpertReportBtn" class="btn btn-primary">전문가용 (전체 항목)</button>
                <div id="report-gen-loading" style="display: none; margin-top: 15px; text-align: center;">
                    <p style="color: red; margin: 0;">보고서를 생성하고 있습니다. 잠시만 기다려주세요...</p>
                </div>
                <div id="report-gen-error" class="error-message" style="text-align: center;"></div>
            </div>
            <div class="modal-footer">
                <button id="cancelSelectionReportBtn" class="btn btn-secondary">닫기</button>
            </div>
        </div>
    </div>

    <!-- Details Modal -->
    <div id="ideaModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">구체적인 사항</h3>
                <button id="closeModal" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <p id="modal-checkpoint" style="font-weight: 500; margin-bottom: 1rem;"></p>
                <ul id="modal-ideas" style="list-style-type: disc; padding-left: 20px;"></ul>
            </div>
            <div class="modal-footer">
                <button id="okModal" class="btn btn-primary">확인</button>
            </div>
        </div>
    </div>
    
    <!-- Report Modal -->
    <div id="reportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="report-title">인간공학 체크포인트 현황</h3>
                <button id="closeReportModal" class="modal-close">&times;</button>
            </div>
            <div class="modal-body" id="report-modal-content">
                <!-- Report content goes here -->
            </div>
            <div class="modal-footer">
                <button id="printReportBtn" class="btn btn-primary">인쇄하기</button>
                <button id="closeReportBtn" class="btn btn-secondary">닫기</button>
            </div>
</div>
    </div>

<div id="manualModal" class="modal">
    <div class="modal-content" style="max-width: 700px;">
        <div class="modal-header">
            <h3>사용자 매뉴얼</h3>
            <button id="closeManualModal" class="modal-close">&times;</button>
        </div>
        <div class="modal-body" id="manual-modal-content">
            <h4 style="color: #1e3a8a;">👋 안녕하세요! 안전보건 코딩입니다.</h4>
            <p>이 도구는 ILO의 인간공학 체크포인트를 기반으로, 작업 환경을 점검하고 개선하는 데 도움을 드립니다.</p>
            
            <h4 style="margin-top: 20px; color: #1e3a8a;">1. 📖 기본 기능 (메인 화면)</h4>
            <ul style="list-style-type: disc; padding-left: 20px;">
                <li style="margin-bottom: 10px;">
                    <strong>체크포인트 점검:</strong> 132개의 기본 인간공학 체크포인트를 스크롤하며 확인할 수 있습니다.
                </li>
                <li style="margin-bottom: 10px;">
                    <strong>구체적인 사항 (보기):</strong> '보기' 버튼을 누르면, 해당 항목을 개선할 수 있는 구체적인 아이디어와 팁을 볼 수 있습니다.
                </li>
                <li style="margin-bottom: 10px;">
                    <strong>조치 여부 (체크박스):</strong> 항목을 개선했거나 조치했다면, 오른쪽의 토글 스위치를 켜서 상태를 저장할 수 있습니다.
                </li>
            </ul>

            <h4 style="margin-top: 20px; color: #1e3a8a;">2. ⚙️ 메뉴 기능 (오른쪽 상단 '...')</h4>
            <ul style="list-style-type: disc; padding-left: 20px;">
                <li style="margin-bottom: 10px;">
                    <strong>불러오기:</strong> '저장하기'로 다운로드했던 CSV 파일을 선택해, 이전에 작업했던 '조치 여부' 상태를 그대로 복원합니다.
                </li>
                <li style="margin-bottom: 10px;">
                    <strong>저장하기:</strong> 현재의 '조치 여부' 체크박스 상태를 CSV 파일로 PC에 다운로드합니다. (작업 내역 백업)
                </li>
                <li style="margin-bottom: 10px;">
                    <strong>체크포인트(인쇄용) 생성:</strong>
                    <ul style="list-style-type: circle; padding-left: 20px; margin-top: 5px;">
                        <li>현재 체크된 '조치 여부'를 바탕으로 인쇄용 보고서를 생성합니다.</li>
                        <li><strong>작업자용/관리자용:</strong> AI가 원본 132개 항목 중 핵심 항목을 선별한 기본 보고서입니다.</li>
                        <li><strong>전문가용 (전체):</strong> 132개 전체 항목 보고서입니다.</li>
                    </ul>
                </li>
                <li style="margin-bottom: 10px;" class="ai-manual-only">
                    <strong>AI 맞춤 업종&작업별 설문 생성:</strong>
                    <ul style="list-style-type: circle; padding-left: 20px; margin-top: 5px;">
                        <li>'업종' (예: 건설업)과 '작업내용' (예: 용접)을 입력하면, AI가 3~5분간 작업을 수행합니다.</li>
                        <li>완료되면, 입력한 업종/작업에 맞게 <strong>모든 문항(132개)이 재작성된</strong> 새로운 HTML 파일이 PC에 다운로드됩니다.</li>
                        <li>이후에는 다운로드한 새 HTML 파일을 열어서 '맞춤형' 설문을 사용하시면 됩니다.</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div class="modal-footer">
            <button id="okManualModal" class="btn btn-primary">확인</button>
        </div>
    </div>
</div>

<div id="aiConfigModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>AI 맞춤 업종&작업별 체크포인트 생성</h3>
                <button id="closeAiConfigModal" class="modal-close">&times;</button>
            </div>
	<div class="modal-body">
                <p style="color: blue">업종과 작업내용을 입력하시면, AI가 현재 체크포인트를 맞춤형으로 재작성합니다.</p>
                <div class="form-group">
                    <label for="industry-input">업종<span style="font-weight: 300; font-size: 14px;"> (예: 건설업, 제조업, 서비스업 또는 화학제품제조업, 선박건조수리업 등 업종 대/중 분류)</span></label>
                    <input type="text" id="industry-input" placeholder="업종을 입력하세요">
                </div>
                <div class="form-group">
                    <label for="job-type-input">작업내용<span style="font-weight: 300; font-size: 14px;"> (예: 용접, 조립, 세척작업, 비계설치해체 등 구체적인 수행 업무)</span></label>
                    <input type="text" id="job-type-input" placeholder="수행하는 작업내용을 입력하세요">
                </div>
                <div id="ai-error-message" class="error-message"></div>

                <div id="ai-progress-container" style="display: none; width: 100%; margin-top: 15px;">
                    <div class="progress-item">
                        <label id="progress-label-1" for="progress-bar-1">1/3: 전문가용 생성 대기 중...</label>
                        <div class="progress-bar-bg">
                            <div id="progress-bar-1" class="progress-bar-fg"></div>
                        </div>
                    </div>
                    <div class="progress-item">
                        <label id="progress-label-2" for="progress-bar-2">2/3: 관리자용 생성 대기 중...</label>
                        <div class="progress-bar-bg">
                            <div id="progress-bar-2" class="progress-bar-fg"></div>
                        </div>
                    </div>
                    <div class="progress-item">
                        <label id="progress-label-3" for="progress-bar-3">3/3: 작업자용 생성 대기 중...</label>
                        <div class="progress-bar-bg">
                            <div id="progress-bar-3" class="progress-bar-fg"></div>
                        </div>
                    </div>
                </div>
                <p id="ai-loading-message" style="color: red; display: none; margin-top: 10px;">입력하신 업종과 작업내용에 적합한 설문문항 전체를 생성하기 때문에 장시간이 걸립니다. 잠시만 기다려 주세요.</p>
            </div>

            <div class="modal-footer">
                <button id="applyAiConfigBtn" class="btn btn-primary">
                    <span class="btn-text">적용하기</span>
                    <div class="spinner" style="display: none;"></div>
                </button>
                <button id="cancelAiConfigBtn" class="btn btn-secondary">닫기</button>
            	</div>
</div>
    </div>

<script>
// CHECKLIST_DATA_START
    let checklistData = [
        {
            category: "재료 보관과 취급",
            checkpoints: [
                { id: 1, text: "운반통로를 표시하고 청결히 유지하라.", ideas: ["작업장소로 가는 운반통로 또는 작업장소 간의 운반통로를 보관장소와 구별되게 정하고 페인트로 표시한다.", "운반통로가 동력기계나 보관재료 가까이 있을 때에는 난간이나 울타리를 설치한다.", "정해진 운반통로 위에는 아무것도 놓거나 남겨두지 않도록 한다.", "보관용 선반, 랙, 팔레트 등을 운반통로 표시와 동시에 마련하여 통로를 깨끗하게 유지하는 습관을 확립한다."] },
                { id: 2, text: "통로와 복도는 양방향 통행이 가능토록 충분한 넓이를 유지하라.", ideas: ["통로나 복도의 장애물을 제거하여 원활한 통행이 가능하도록 하고 양쪽에 표시를 한다.", "재료 운반을 위한 통로는 양방향 통행이 가능하도록 최소 125-140cm 넓이를 확보한다.", "이동식 선반과 손수레가 쉽게 통행할 수 있는지 확인한다.", "양방향 통행이 불가능한 장소에서는 휴대하기 쉬운 팔레트나 작은 트레이를 사용한다."] },
                { id: 3, text: "운반통로 표면을 평평하고 미끄럽지 않으며 장애물이 없게 하라.", ideas: ["운반통로에 높낮이가 갑자기 달라지는 곳이나 걸려 넘어질 수 있는 물건을 제거한다.", "쏟아진 물, 기름 등 미끄러운 물질을 일상적으로 제거하고, 덮개가 있는 운반용 용기를 사용한다.", "평평하지 않은 부분을 즉시 제거할 수 없으면 연결경사로(ramp), 보충재 등을 사용한다.", "수레, 이동식 받침대 등 바퀴달린 운반장치의 사용을 권장한다."] },
                { id: 4, text: "작업장의 경사로는 작은 계단이나 높낮이가 급격한 대신에 경사각도가 완만하도록 하라.", ideas: ["작지만 급격한 높낮이 변화가 있는 통로나 계단은 경사도가 적은(5-8도 이내) 경사로로 대체한다.", "휠체어 접근이 가능하도록 경사도를 적절히 디자인한다.", "설치된 경사로의 표면이 미끄럽지 않고 방해물이 없도록 한다.", "경사로 옆으로 넘어질 위험이 있는 경우 난간이나 울타리를 설치한다."] },
                { id: 5, text: "작업장의 배치를 개선하여 재료의 운반거리를 최소화하라.", ideas: ["근로자와 상의하여 기계와 작업대의 배치를 변경함으로써 운반 횟수와 거리를 줄인다.", "작업대 간 물품 이동을 최소화하기 위해 일단의 작업대들을 서로 가까이 배치한다.", "작업순서에 맞추어 서로 다른 작업부서를 배치한다.", "가능한 한 작업들을 서로 결합시켜 재료 이동 필요를 줄인다."] },
                { id: 6, text: "재료 운반에는 카트, 손수레 기타 바퀴나 롤러가 달린 기구를 사용하라.", ideas: ["재료 이동이 빈번하거나 힘이 드는 경우, 수레나 '바퀴' 사용을 고려한다.", "재료운반을 위해 적당한 크기의 단순한 미는 수레를 설계하거나 제작한다.", "다음 작업대로 재료를 쉽게 밀어 보낼 수 있는 롤러 라인을 설치한다.", "미는 수레에 쉽게 올리거나 롤러 위에서 밀어 보낼 수 있는 받침대, 통, 용기 등을 사용한다."] },
                { id: 7, text: "불필요하게 싣고 내리기를 반복하지 않게 재료보관용 이동선반을 사용하라.", ideas: ["바퀴와 정지장치가 달린 선반, 용기, 스탠드 등을 설계하거나 구매한다.", "바퀴달린 선반이 부드럽게 통행할 수 있도록 작업장 내 배치를 개선한다.", "이동식 선반이나 손수레에 실을 수 있는 팔레트, 컨테이너, 트레이 사용을 고려한다.", "기존의 스탠드, 선반 등에 바퀴를 달아 이동 가능하게 만든다."] },
                { id: 8, text: "손으로 재료를 자주 옮기는 것을 최소화하도록 여러 층의 선반이나 받침대를 작업구역 가까이 두고 사용하라.", ideas: ["각종 특정 물품들을 위한 다층의 앞이 열려있는 선반을 제공한다.", "작업구역 가까이 있는 벽에 여러 층의 선반을 두어 공간을 최대한 활용한다.", "가능하면 선반에 바퀴를 달아 움직일 수 있게 만든다.", "각 종류별로 놓을 수 있는 장소를 정하고 표찰을 붙여 보관, 운반 및 찾기가 쉽게 한다."] },
                { id: 9, text: "무거운 재료를 올리고, 내리고, 옮길 때에는 기계장치를 이용하라.", ideas: ["필요한 최소한의 거리를 인양하는 기중기, 유압식 인양기, 리프트 테이블 등을 설치한다.", "천장용 장치보다는 바닥 기반의 인양기를 우선적으로 고려한다.", "제조자나 권한 있는 자가 검사하고 최대 적재하중을 표시한 인양기만을 사용한다.", "자격 있는 사람이 정기적으로 인양기계, 체인, 로프 등을 검사한다."] },
                { id: 10, text: "컨베이어나 호이스트, 기타 기계를 사용하여 손으로 재료를 취급하는 경우를 줄여라.", ideas: ["인력으로 물건을 취급하는 작업 중 기계로 대체할 수 있는 것을 검토한다.", "유압식 리프트 테이블, 바닥크레인, 호이스트와 같은 인력으로 조종하는 장비를 사용한다.", "필요시 전기용 또는 유압식 리프트, 컨베이어 등 동력으로 조종하는 장비를 사용한다.", "기계로 하는 운반이 비현실적일 때에는 중력이나 경사진 롤러를 이용한다."] },
                { id: 11, text: "무거운 물건을 운반하는 대신 작고 가벼운 무게의 상자, 용기, 트레이로 분할하라.", ideas: ["인력으로 올리거나 운반하는 짐을 보다 작은 짐으로 분할할 수 있는지 검토한다.", "근로자가 수월하게 일할 수 있는 무게를 고려하여 짐을 분hal한다. (예: 20kg 1개보다 10kg 2개가 나음)", "한 번에 여러 개의 상자를 운반할 때에는 수레나 이동식 선반을 사용한다."] },
                { id: 12, text: "모든 상자나 용기에 손잡이 등 안전하게 쥐거나 잡을 수 있는 곳을 제공하라.", ideas: ["상자, 트레이, 컨테이너 등에 손으로 편하게 쥘 수 있는 홈을 판다.", "운반하는데 손잡이나 쥐기가 좋은 상자를 사용한다.", "물품공급자에게 손잡이가 있는 상자를 사용하도록 요청한다.", "손잡이 위치를 몸 앞쪽에서 짐을 운반할 수 있도록 한다."] },
                { id: 13, text: "물건은 작업높이와 같은 높이에서 수평으로 이동하라.", ideas: ["한 작업대에서 다른 작업대로 물건을 이동할 때 동일한 작업높이에서 이동시킨다.", "물건 운반 시 높낮이의 변화가 없이 운반하는 시스템(롤러, 이동식 작업대 등)을 사용한다.", "물건을 싣거나 내릴 때 높낮이 변화를 최소화하도록 운송수단의 바닥 높이를 맞춘다.", "물건을 투입하는 곳이나 작업대로 옮기는 작업에는 간단한 승강장비나 이동식 리프트 테이블을 사용한다."] },
                { id: 14, text: "재료를 취급할 때 몸을 구부리거나 비트는 동작의 작업이 없도록 하라.", ideas: ["몸을 구부리지 않고 몸 앞쪽에서 작업할 수 있도록 물건의 위치/자세를 변화시킨다.", "몸을 구부리거나 꼬지 않고 작업할 수 있게 작업공간을 개선한다.", "작업용 물건을 근로자 앞으로 가져오는데 기계적인 수단을 이용한다.", "작업대나 재료 투입지점의 높이를 높여 작업의 높이를 변화시킨다."] },
                { id: 15, text: "손으로 물건을 취급할 때에는 몸 가까이에 두고 작업하도록 하라.", ideas: ["운반하는 짐에 손잡이를 만들어 몸에 최대한 가까이 하고 단단히 잡는다.", "무거운 물건을 인력으로 올려야 한다면 두 명 이상이 같이 하도록 한다.", "무거운 물건을 올릴 때는 등을 펴고 다리근육의 힘을 사용한다.", "운반하는 물건을 최소한으로 올리거나 내리도록 작업 계획을 세운다."] },
                { id: 16, text: "무거운 물건을 올리는 작업은 육체적으로 가벼운 작업과 결합시켜 부상이나 피로를 방지하고 일의 효율성을 높이도록 하라.", ideas: ["무거운 물건을 올리는 작업을 하는 근로자들이 가벼운 일도 하도록 작업을 재조직한다.", "힘든 일이 일부 근로자에게 집중되지 않도록 교대작업이나 그룹작업을 도입한다.", "모두가 비슷하게 힘든 작업인 경우에는 일단의 근로자들이 교대제로 돌아가면서 하도록 한다."] },
                { id: 17, text: "휴지통은 편리한 위치에 두어라.", ideas: ["각 폐기물의 형태에 따른 적절한 용기를 구입하거나 제작한다.", "폐기물 용기 밑에 바퀴를 달아 자주 쉽게 버릴 수 있게 한다.", "기름이나 액체가 떨어지는 곳 밑에 착탈식 트레이를 설치한다.", "근로자들과 폐기물을 비워야 하는 최적의 주기에 대해 협의하고 담당자를 지정한다."] }
            ]
        },
        {
            category: "수공구",
            checkpoints: [
                { id: 18, text: "어떤 업무가 필요로 하는 대로 설계한 공구를 선택한다.", ideas: ["작업에 맞는 특수용도의 공구를 사용한다.", "자주 힘들게 해야 하는 작업이면 전동공구를 사용한다.", "공구를 넣어두는 함을 마련하고 정기적으로 유지보수한다.", "손가락의 힘을 과도하게 사용하는 공구는 피한다."] },
                { id: 19, text: "안전한 동력공구를 제공하고 안전장치가 사용되고 있는지 확인하라.", ideas: ["안전성을 검토한 후에 동력식 공구를 주문한다.", "균형이 잘 잡히도록 설계된 공구를 구매한다.", "방호장치가 근로자를 보호하기에 충분하고 잘 사용되고 있는지 확인한다.", "조정장치가 의도하지 않게 작동되는 것을 막기 위한 수단이 있는지 점검한다."] },
                { id: 20, text: "같은 장소에서 반복 사용되는 공구는 걸어두는 장치를 이용하라.", ideas: ["반복적으로 사용되는 공구를 골라 걸어두도록 한다.", "근로자 앞에 수평으로 틀을 만들어 공구를 걸어두고, 스프링에 의해 자동으로 제자리로 돌아가게 한다.", "걸려 있는 공구는 근로자의 손이 닿을 수 있는 위치에 있도록 한다.", "작업을 하지 않을 때 걸려 있는 공구가 방해가 되지 않도록 한다."] },
                { id: 21, text: "재료나 작업하고 있는 물건을 고정시키기 위해서는 조임쇠(vice)나 고정쇠(clamp)를 사용하라.", ideas: ["작업하는 물품의 크기, 모양 등을 고려하여 적절한 조임쇠와 고정쇠를 선택한다.", "가능하면 작업대 표면 위에 고정쇠 위치를 조정할 수 있게 한다.", "다른 방향에서도 접근할 필요가 있는 경우 회전할 수 있는 고정쇠를 선정한다.", "근로자가 자연스러운 자세로 작업할 수 있는 위치에 둔다."] },
                { id: 22, text: "정밀공구를 사용할 때는 손지지대를 사용하라.", ideas: ["손이나 손과 팔 앞부분이 작업 중 지지될 수 있게 지지대를 사용한다.", "여러 형태와 모양의 손 지지대를 시험해보고 가장 기능이 좋은 것을 선택한다.", "적당하다면 정밀 공구는 한 지지대 위에 계속 올려 놓는다."] },
                { id: 23, text: "공구의 무게를 최소화하라(내려치는 공구는 제외).", ideas: ["작업에 적합하고 최대한 가벼운 공구를 선택한다.", "안정된 받침대로 공구를 지지하여 무게를 줄인다.", "적절하다면 공구를 표면 위를 미끄러지게 하여 표면이 공구를 지지하게 한다.", "공구의 중력 중심보다 위쪽에 매달아 둔다."] },
                { id: 24, text: "손으로 사용하는 수공구는 쉽게 사용할 수 있게 적절한 길이, 모양, 크기의 손잡이를 갖도록 하라.", ideas: ["손 전체로 잡는 경우 손잡이 직경이 30-40mm인지 확인한다.", "손잡이 길이는 최소 100mm, 장갑을 끼는 경우 125mm가 되도록 한다.", "공구 사용 중 손목이 중립위치에 있을 수 있는지 확인한다.", "오른손잡이, 왼손잡이 모두 사용할 수 있는 공구를 구입한다."] },
                { id: 25, text: "손으로 사용하는 수공구는 미끌어지거나 다치게 하는 일이 없도록 손잡이에 적절한 마찰력, 안전장치 또는 미끄러짐 방지장치가 있도록 하라.", ideas: ["손잡이 단면을 비원형으로 하고 표면은 마찰계수가 높은 재질로 하여 공구가 손 안에서 돌아가지 않게 한다.", "손이 앞으로 움직이는 것을 줄이기 위해 쐐기모양의 공구를 사용한다.", "칼, 납땜인두 등 공구의 앞 쪽에 방호장치나 제동장치를 사용한다.", "손잡이 끝부분을 말 안장 끝 모양으로 볼록하게 만들어 놓치는 것을 방지한다."] },
                { id: 26, text: "공구는 화상이나 전기충격을 방지할 수 있게 적절하게 피복되도록 하라.", ideas: ["공구 손잡이 표면은 고무, 나무, 플라스틱 같이 열 전도율이 낮은 것을 사용한다.", "금속 손잡이는 얇은 플라스틱이라도 피복을 입힌다.", "정기동력을 사용하는 수공구는 접지플러그를 사용하고 손잡이가 2중으로 피복된 것을 사용한다."] },
                { id: 27, text: "수공구의 진동이나 소음을 최소화하라.", ideas: ["소음 발생 작업을 다른 작업부서와 분리한다.", "소음노출한계(85-90dB) 이하로 소음수준을 줄인다.", "진동수준과 소음수준이 낮은 수공구를 구입한다.", "작동하지 않을 때 자동으로 동력이 차단되는 공구를 사용한다."] },
                { id: 28, text: "각 공구마다 공구함을 마련하라.", ideas: ["선반, 서랍, 랙, 트롤리, 걸이 등 공구의 모양, 크기, 무게에 맞는 공구함을 마련한다.", "큰 공구도 바닥에 두지 않도록 큰 공구함을 마련한다.", "공구판을 사용하는 경우, 판에 공구의 모습을 그려 위치를 표시한다.", "자주 사용하는 공구일수록 작업대 가장 가까이 둔다."] },
                { id: 29, text: "수공구를 정기적으로 점검하고 유지 보수하라.", ideas: ["믿을 수 있는 수공구를 구입하고 작동이 안 되면 즉시 교체한다.", "수공구에 대한 정기적인 검사를 규칙으로 삼는다.", "여분의 수공구나 부품을 현장에 둔다.", "고장 시 부품을 쉽게 교체할 수 있도록 대체 모듈을 제공한다."] },
                { id: 30, text: "동력공구는 근로자들이 사용하기 전에 훈련시켜라.", ideas: ["올바른 사용에 대한 설명서가 첨부된 공구를 구매한다.", "근로자들과 면담하여 공구의 잘못된 사용으로 야기된 문제점을 파악한다.", "올바른 사용법에 대해 훈련 및 재훈련할 시간을 만든다.", "기술이 높은 근로자가 다른 근로자들을 훈련시키도록 한다."] },
                { id: 31, text: "동력공구 사용시에는 안정적인 자세와 안정적인 자리를 확보할 수 있게 충분한 공간을 제공하라.", ideas: ["작업장 바닥은 고르고 평평하며 미끄럽지 않아야 한다. 필요시 플랫폼을 제공한다.", "공구 조작에 방해가 될 수 있는 물건은 제거한다.", "안정된 자세로 작업할 수 있도록 무릎과 발 부근에 충분한 공간을 제공한다.", "미끄러진 경우 비상정지나 자동정지가 되도록 하는 장치를 갖춘다."] }
            ]
        },
        {
            category: "기계안전",
            checkpoints: [
                { id: 32, text: "기계의 의도하지 않은 작동을 방지할 수 있는 통제 장치를 설계하라.", ideas: ["의도하지 않게 작동될 수 있는 조정장치를 서로 분리시킨다.", "의도하지 않게 작동될 수 있는 조정장치에 덮개나 케이지를 만든다.", "조정장치를 누르지 않고 잡아당겨야 작동되도록 하는 방법을 택한다.", "중요한 조정장치(비상스위치 등)는 다른 조정장치와 떨어진 곳에 배치한다."] },
                { id: 33, text: "조작자가 평상시 위치에서 분명하게 볼 수 있고, 쉽게 조작할 수 있는 비상정지장치를 만들어라.", ideas: ["비상정지장치나 줄은 쉽게 손닿는 곳에 위치시킨다.", "비상정지장치는 큼직하고 조작하기 쉽게 만든다.", "비상정지장치는 빨간색이나 비상상황을 의미하는 색으로 표시한다.", "비상정지장치는 무심결에 작동되지 않도록 다른 조정장치와 떨어진 곳에 위치시킨다."] },
                { id: 34, text: "조정장치는 각 장치를 쉽게 구별할 수 있게 만들어라.", ideas: ["서로 다른 색깔, 크기, 모양을 사용한다.", "조정장치에 분명하고 간단명료한 표지를 붙인다.", "유사한 기계의 공통적인 조정장치는 표준화하여 배치한다."] },
                { id: 35, text: "근로자가 모든 조정장치를 쉽게 볼 수 있고 쉽게 손이 닿을 수 있는지 확인하라.", ideas: ["자주 사용하는 조정장치는 조작자 앞에 팔꿈치 높이로 배치한다.", "2차적으로 중요한 조정장치는 가장 중요한 조정장치 바로 옆에 배치한다.", "조정장치가 너무 높으면 발판을 사용하고, 너무 낮으면 기계 밑에 플랫폼을 받친다.", "조작자의 크기에 맞게 조절할 수 있는 작업대나 기계를 구입한다."] },
                { id: 36, text: "조정장치는 조작순서에 맞게 배치하라.", ideas: ["기계조작의 부차적 업무(전원 ON/OFF, 설치 등)을 파악한다.", "각 부차적 업무와 관련된 조정장치를 그룹화하여 재배치한다.", "각 부차적 업무 안에서의 조작순서에 따라 조정장치 위치를 정한다.", "조정장치를 구별하기 쉽도록 색깔, 크기, 모양 등으로 코드화한다."] },
                { id: 37, text: "조정장치의 조작은 다음 조작이 자연스럽게 예상할 수 있게 하라.", ideas: ["'켜기'는 오른쪽/앞쪽/시계방향, '끄기'는 왼쪽/뒤쪽/시계반대방향 등 일반적인 예상을 활용한다.", "다른 기계나 동력 스위치도 같은 원칙을 따르도록 한다.", "다이얼 동작과 조종동작이 서로 일치하도록 한다."] },
                { id: 38, text: "발판페달은 그 수가 너무 많지 않게 하고 조작이 쉽도록 하라.", ideas: ["페달 수를 최소한으로 하고, 한 발로만 계속 조작하는 페달은 최소화한다.", "발의 자세가 불편하지 않도록 페달 위치를 바닥 높이로 한다.", "페달의 위치를 바닥으로 옮길 수 있도록 한다.", "페달 옆에 발이 쉴 수 있는 자리를 마련한다."] },
                { id: 39, text: "표시장치와 신호는 서로 구분하기 편하고 쉽게 읽을 수 있게 하라.", ideas: ["중요한 표시장치나 신호는 조작자가 늘 주시하는 장소에 위치시킨다.", "다른 표시장치나 신호는 다른 크기, 모양, 색깔을 사용한다.", "문자나 숫자 등은 먼 거리에서도 잘 읽을 수 있게 크기를 크게 한다.", "표시장치를 읽기 쉽도록 너무 상세한 표시나 많은 숫자를 피한다."] },
                { id: 40, text: "표시장치에는 근로자들이 무엇을 해야 하는지 쉽게 알 수 있게 표시나 색깔을 사용하라.", ideas: ["어떤 조치가 필요한 지점이나 부분을 가리키는 표시를 해 둔다.", "안전한 것을 나타내는 초록색이나 경고를 나타내는 빨간색 등 색깔을 사용한다.", "쉽게 감시할 수 있도록 관련된 표시장치를 그룹화하거나 조직화한다."] },
                { id: 41, text: "부호(symbol)는 현장 근로자들이 쉽게 알 수 있는 경우에만 사용하라.", ideas: ["관련 근로자들이 확실히 쉽게 이해할 수 있을 때에만 부호를 사용한다.", "일부 근로자가 이해하지 못하는 부호가 있다면, 그 기계에 표지를 만들어 붙인다.", "표지는 현지의 문화와 관념에 맞게 설계되어야 하며, 금속이나 플라스틱으로 만든다."] },
                { id: 42, text: "라벨(label)과 표지(sign)는 쉽게 볼 수 있고, 쉽게 읽을 수 있으며, 쉽게 이해할 수 있게 만들어라.", ideas: ["사람들이 자주 바라보는 장소에 붙인다.", "표지나 신호의 글자는 멀리서도 쉽게 보이도록 커야 한다.", "서로 다른 표지나 신호는 다른 색깔이나 모양을 사용한다.", "표지 내용이 간단명료하게 하고 너무 길거나 혼란스럽지 않도록 한다."] },
                { id: 43, text: "경고표지는 근로자들이 쉽고 정확하게 이해할 수 있는 것을 사용하라.", ideas: ["경고표시는 신호 단어(위험/경고/주의), 유해위험, 결과, 지시의 네 가지 요소를 포함해야 한다.", "짧은 내용이 긴 것보다 더 효과적이다.", "문자로 된 경고표시에 이해하기 좋은 부호를 함께 사용하는 것이 좋다."] },
                { id: 44, text: "기계조작이 안전하고 안정적, 능률적이 되도록 지그(JIG)등 고정기구를 사용하라.", ideas: ["공구나 기계 부위를 작업물의 정확한 위치로 인도하는 지그를 설계한다.", "하나 또는 여러 개의 작업물을 잡아주는 고정구를 사용한다.", "지그나 고정구는 착탈이 쉽도록 해야 한다.", "지그와 고정구의 부품은 표준화하여 비용과 수리시간을 최소화한다."] },
                { id: 45, text: "기계 구입 시 안전기준을 충족시키는 기계를 구입하라.", ideas: ["모든 구동부분이 방호되어 있고, 손으로 조작하는 부분이 위험하지 않은 기계를 주문한다.", "기계 작동 중에 손이 위험한 지점에 들어가지 않고 안전하게 물건을 투입/배출할 수 있는지 점검한다.", "기계의 유지보수가 안전하게 수행될 수 있는지 점검한다.", "방호장치가 없거나 안전하지 않은 기계는 구매하지 않는다."] },
                { id: 46, text: "기계의 위험부위에 손이 가까이 가지 않도록 자동 공급 장치, 배출장치를 사용하라.", ideas: ["플런저 피트, 회전 피드, 중력 활송장치 피드 등 단순한 형태의 공급/배출장치를 사용한다.", "반 고체형이나 알갱이 형태의 물건은 압축공기를 이용한다.", "갈고리, 막대기 등 공급 보조장치를 사용할 수도 있다."] },
                { id: 47, text: "기계의 움직이는 부위와 접촉되지 않도록 고정식 울타리나 방호벽을 사용하라.", ideas: ["기계 자체와 비산하는 물체로부터 보호할 수 있는 고정식 방호장치를 설계한다.", "하고 있는 작업을 선명하게 볼 수 있도록 투명한 재질로 만든 방호장치를 사용한다.", "기계의 한 부위가 다른 부위와 맞물리는 곳에 고정 장벽이나 방호장치를 설치한다.", "두 롤러가 맞물리는 곳에 손이나 옷깃이 말려들지 않도록 방호벽을 세운다."] },
                { id: 48, text: "기계의 작동 중에는 근로자가 위험부위에 닿을 수 없게 기계가 작동하면 자동으로 장벽이 막히는 연동식 방호벽을 사용하라.", ideas: ["문이 달린 울타리를 설치하고, 문이 열리면 자동으로 동력공급이 단절되는 연동식 장벽을 사용한다.", "기계식 연동장치가 어려우면 광학식 연동시스템을 사용한다.", "연동식이 불가능할 때에는 양수조작식을 사용할 수 있다."] },
                { id: 49, text: "작업장을 개조하고 적절한 훈련을 실시하여 지게차 운전의 안전작업절차를 확립하라.", ideas: ["지게차가 다니는 길의 표면을 평평하도록 보수하고, 사람 다니는 길과 구분한다.", "매일 사용 전 체크리스트를 사용하여 지게차를 점검한다.", "안전벨트를 확보하고 적정용량 범위 내에서 짐을 싣는다.", "지게차 안전운전에 대해 운전자를 훈련시킨다."] },
                { id: 50, text: "전선을 포함하여 기계를 정기적으로 점검하고, 청소하고, 유지보수하라.", ideas: ["정기검사, 청소, 예방적 유지보수 등의 계획을 세운다.", "각 작업구역 및 기계마다 검사 및 유지보수 기록부를 만든다.", "근로자들을 훈련시켜 각자 작업구역의 기계를 검사하고 결함을 보고하도록 한다.", "수리중이거나 유지보수 중일 때는 기계 조종장치를 잠그고 '작동금지' 표지를 붙인다."] }
            ]
        },
        {
            category: "작업대 디자인",
            checkpoints: [
                { id: 51, text: "각 근로자마다 작업높이가 팔꿈치 또는 약간 그 아래가 되도록 조정하라.", ideas: ["앉아서 작업 시 작업높이는 팔꿈치 수준으로 한다.", "서서 작업 시 손의 높이는 팔꿈치 약간 아래가 되어야 한다.", "가능하면 높낮이 조절이 가능한 작업대를 사용한다.", "발판이나 작업대 밑에 까는 판 등을 사용하여 작업높이를 조정한다."] },
                { id: 52, text: "작업장은 키가 작은 근로자들에게도 편리하도록 편의를 제공하라.", ideas: ["높이 조절이 가능한 기계나 장비를 구입한다.", "키 작은 근로자들이 쉽게 손이 닿도록 조종장치와 재료들을 교체한다.", "발판을 사용하여 손의 위치를 높여준다.", "손이 닿기 힘든 경우 이동식 발판을 사용한다."] },
                { id: 53, text: "작업장은 키가 큰 근로자들에게도 편리하도록 편의를 제공하라.", ideas: ["키 큰 근로자를 통해 작업대와 통로의 공간을 점검하고 필요시 넓힌다.", "작업대의 무릎과 다리 주변 공간을 점검하고 필요시 확장한다.", "안전하지 않은 공간은 밝은 색과 경고표지로 표시한다."] },
                { id: 54, text: "자주 사용하는 재료, 공구, 조종장치는 손이 쉽게 닿을 수 있는 곳에 두어라.", ideas: ["자주 사용하는 공구와 조종장치는 손이 주로 움직이는 범위(몸 앞쪽 15-40cm, 옆으로 40cm) 안에 둔다.", "자주 사용하는 재료는 손이 주로 움직이는 거리 안에 둔다.", "비슷한 작업대의 경우 물품 배치를 표준화한다.", "왼손 근로자에게는 그에 맞게 조정해 준다."] },
                { id: 55, text: "작업대는 그 표면구조가 안정적이고 다양한 작업을 하기에 적합하게 하라.", ideas: ["다양한 작업을 할 수 있는 적절한 크기의 안정된 작업대를 갖춘다.", "임시적이거나 표면이 고르지 못한 작업대는 피한다.", "작업대의 두께는 5cm를 넘지 않아야 한다.", "VDU 작업대의 경우 키보드 외에 다른 작업을 할 수 있는 공간을 확보한다."] },
                { id: 56, text: "근로자들이 자연스럽게 두 발에 몸무게를 싣고 서서 몸 앞쪽 가까운 위치에서 작업할 수 있게 하라.", ideas: ["중요하고 자주 행하는 모든 작업을 팔꿈치 높이에서 몸 바로 앞 가까이에서 할 수 있도록 한다.", "자주 행하는 작업 시 오랜 시간 팔꿈치를 높이 올리거나 몸을 구부리거나 꼬지 않도록 한다.", "조절가능한 작업대를 제공하거나, 발판 등으로 작업높이를 조절한다."] },
                { id: 57, text: "근로자들이 작업 시 앉거나 서기를 최대한 자주 반복할 수 있게 하라.", ideas: ["정밀작업은 앉아서, 힘을 사용하는 일은 서서 할 수 있는 작업장소를 제공한다.", "앉거나 서기를 반복하며 다른 작업을 함께 할 수 있도록 업무를 부여한다.", "주로 서서 일하는 경우 가끔씩 앉을 수 있게 해준다.", "주로 앉아서 일하는 경우 가끔씩 서 있을 수 있게 한다."] },
                { id: 58, text: "서서 일하는 근로자에게 가끔씩 앉을 수 있게 의자나 팔걸이가 없고, 등받이가 없는 의자를 제공하라.", ideas: ["서서 작업하는 근로자 각자에게 의자나 스툴(Stool)을 제공한다.", "근로자들이 필요할 때 의자를 사용하도록 공식적으로 허용한다.", "서서 하는 업무 중 일부를 앉아서도 할 수 있는지 검토하고 조치한다."] },
                { id: 59, text: "앉아서 일하는 근로자에게 조절이 가능하고 등받이가 있는 의자를 제공하라.", ideas: ["높낮이를 조절할 수 있는 의자를 제공한다.", "허리높이에 등받침이 있는 의자를 사용한다.", "너무 딱딱하거나 부드럽지 않은 패딩으로 된 의자 바닥을 갖춘다.", "다섯 개의 다리에 바퀴가 달린 의자가 여러 작업에 좋다."] },
                { id: 60, text: "높낮이 조절이 가능한 컴퓨터 작업대를 사용하고, 컴퓨터 주변장치를 가까운 곳에 배치하라.", ideas: ["책상, 의자, 컴퓨터 모니터 등 높이 조절이 가능한 집기를 사용한다.", "휴대용 컴퓨터 사용 시 외부 키보드와 별도 모니터를 사용한다.", "키보드나 마우스 받침을 제공한다.", "케이블을 정리하기 위해 케이블 관리시설에 넣는다."] },
                { id: 61, text: "영상장치를 사용하는 근로자들에게 정기적인 눈검사를 실시하고 적절한 안경을 제공하라.", ideas: ["눈의 피로를 경험한 사람은 종합검사를 받도록 한다.", "VDU 작업에 적합한 시력교정을 제공한다.", "최소 2년에 한 번 이상 시력검사를 실시한다.", "눈의 피로를 회복하도록 정기적으로 일을 멈추게 한다."] },
                { id: 62, text: "높은 곳에서 작업하는 근로자에게는 튼튼하고 안전한 발판과 충분한 보호조치를 제공하라.", ideas: ["안전하게 갈 수 있는 단단하고 안정된 발판, 바닥, 비계 등을 제공한다.", "사다리 이용 시 미끄러지지 않도록 단단하게 묶거나 고정한다.", "높이 0.7m 이상의 계단이나 개방된 곳에는 가드레일과 중간 레일을 설치한다.", "일정 높이 이상에서는 안전벨트를 착용하도록 한다."] },
                { id: 63, text: "작업장에서 사용하는 차량의 좌석과 운전실은 보다 안전하고 쾌적하게 만들어라.", ideas: ["충돌이나 전복 시 운전자를 보호할 수 있는 안정된 구조를 갖춘다.", "운전석에 쉽게 올라갈 수 있고 발을 든든하게 딛을 수 있도록 한다.", "운전석이 모든 운전자에게 맞게 조절할 수 있어야 한다.", "고열이나 한랭으로부터 보호하고, 소음과 진동을 줄인다."] }
            ]
        },
        {
            category: "조명",
            checkpoints: [
                { id: 64, text: "햇볕을 많이 사용하고 바깥경치를 볼 수 있도록 하라.", ideas: ["창문을 깨끗이 하고 햇볕이 들어오는 것을 방해하는 물건을 치운다.", "근로자들이 더 많은 햇볕을 받도록 작업장소나 기계 위치를 변경한다.", "창문을 넓히거나 천광창을 만들어 햇볕이 더 들어오도록 한다.", "햇볕이 잘 들어오는 곳의 전등은 끌 수 있도록 스위치를 분리한다."] },
                { id: 65, text: "보다 많은 빛이 필요한 때에는 벽과 천장의 색깔을 밝은 색으로 하라.", ideas: ["천장은 흰색(반사율 80-90%), 벽은 연한 색(반사율 50-85%)을 사용한다.", "벽과 천장의 색깔에 너무 차이가 나지 않도록 한다.", "간접적인 눈부심을 피하기 위해 광택이 나거나 번쩍이는 마감재 사용을 피한다.", "흰색 천장에 위쪽으로 열려 있는 흰색 전등을 사용하여 전체조명을 만든다."] },
                { id: 66, text: "사람들이 걷거나 작업하는 복도, 계단, 경사로 등은 조명을 높여라.", ideas: ["창문, 전등 등을 청소하고 낡은 전구를 교체한다.", "빛의 분산을 방해하는 물건들을 제거한다.", "새로운 조명을 추가하거나 전등 위치를 변경한다.", "계단과 높낮이 차이가 있는 곳을 잘 볼 수 있게 벽 등을 밝은 색으로 칠한다."] },
                { id: 67, text: "작업장소는 밝기의 변화를 최소화하도록 조명을 고르게 하라.", ideas: ["한 곳에만 밝은 빛이 집중되지 않도록 한다.", "고른 조명이 되도록 기존 전등 위치를 바꾸거나 추가한다.", "작업대 배치와 벽/천장 반사를 이용하여 그늘지는 곳이 없도록 한다.", "낡은 형광램프를 교체하여 깜빡거림이 없도록 한다."] },
                { id: 68, text: "근로자들이 언제나 작업을 능률적으로 쾌적하게 할 수 있도록 충분한 조명을 제공하라.", ideas: ["자연광과 인공 빛을 결합하여 사용한다.", "정밀작업, 어두운 색 물건 다루는 작업에는 더 많은 빛을 제공한다.", "램프 위치나 빛의 방향을 바꾼다.", "나이가 많은 근로자가 더 많은 빛을 필요로 한다는 점을 고려한다."] },
                { id: 69, text: "정밀작업 또는 검사작업을 하는 곳에는 부분조명을 제공하라.", ideas: ["정밀작업/검사업무 장소 가까이 또는 위에 부분조명시설을 한다.", "옮기기 쉽고 필요한 곳에 설치하기 쉬운 부분조명을 사용한다.", "부분조명은 닦기 쉽고 유지관리가 쉬운 것을 사용한다.", "전체조명과 부분조명을 항상 잘 결합하여 사용한다."] },
                { id: 70, text: "빛의 직사광선 또는 간접광선을 차단하기 위해 빛의 광원을 재배치하거나 차단막을 설치하라.", ideas: ["표시장치 패널이나 화면을 창문을 향하도록 하지 않는다.", "작업대 가시범위 안에 전구가 노출된 상태로 두지 않는다.", "커튼, 가리개, 칸막이 등을 사용하여 눈부심을 줄인다.", "눈부심을 피하도록 작업대로 비추는 빛의 방향을 바꾼다."] },
                { id: 71, text: "가까이에서 계속 주의를 기울여 응시해야 하는 업무에는 그 시각업무에 적절한 배경을 선택하라.", ideas: ["눈길을 끌어 혼란을 일으키는 것을 가리도록 작업지점 뒤쪽에 막을 설치한다.", "작업대 사이에 칸막이를 설치하여 옆 작업의 방해를 막는다.", "작업물의 윤곽을 잘 볼 수 있도록 뒤에서 빛을 비추는 방식을 사용한다.", "밝은 배경에 작업물 그림자가 지지 않도록 광원을 재배치한다."] },
                { id: 72, text: "창문을 깨끗이 하고 광원을 잘 유지관리해라.", ideas: ["창문과 전등을 깨끗이 청소하는 것을 일상 업무로 한다.", "수명이 다 된 전구와 튜브를 교체하는 것도 유지관리업무에 포함시킨다.", "가능한 많은 전등이 윗부분이 개방되도록 한다.", "낡았거나 부식된 반사막은 교체한다."] }
            ]
        },
        {
            category: "작업장 환경",
            checkpoints: [
                { id: 73, text: "근로자를 고열로부터 보호하라.", ideas: ["작업장 온도를 낮추기 위해 자연통풍 강화, 뜨거운 기계 격리, 국소배기시설 설치 등을 강구한다.", "복사열로부터 근로자를 보호하기 위해 벽이나 스크린을 설치한다.", "고열 노출이 불가피한 경우 노출시간을 최소화하고 보호의를 제공한다.", "선풍기나 환풍기로 공기흐름 속도를 높여준다."] },
                { id: 74, text: "근로자를 차가운 환경으로부터 보호하라.", ideas: ["여러 겹의 옷과 방풍옷, 장갑을 착용한다.", "빌딩과 작업실을 단열처리하고 차가운 공기 흐름 속도를 줄인다.", "중노동 시 더우면 옷을 벗을 수 있도록 여러 겹으로 입는다.", "휴게실은 안락하고 따뜻한 시설을 제공한다."] },
                { id: 75, text: "열이나 냉기의 근원을 격리시키거나 단열처리해라.", ideas: ["열 또는 냉기를 발산하는 기계나 공정을 작업장 밖이나 가까운 곳에 둔다.", "뜨겁거나 차가운 금속표면을 발포고무 등 적절한 절연재질로 피복한다.", "고온의 오븐이나 복사열 발생 물체와 근로자 사이에 차단막을 설치한다.", "냉기가 발생하는 공정에서는 절연피복을 입힌다."] },
                { id: 76, text: "능률적이고 안전하게 일할 수 있게 효과적인 국소배기 장치를 설치하라.", ideas: ["배기할 장소가 좁거나 물질이 유해하면 포위식 국소배기장치를 사용한다.", "포위식이 현실적이지 못하면 후드와 플랜지를 사용한다.", "사용하지 않을 때 닫을 수 있도록 배기덕트나 후드 유입구에 셔터나 커튼을 설치한다.", "오염원이 움직이는 경우 휴대용 압축배기장치를 사용한다."] },
                { id: 77, text: "작업장 내부의 공기질 개선이 필요한 때에는 자연 환기법 사용을 늘려라.", ideas: ["자연적인 공기 흐름이 강한 곳을 작업장소로 선정한다.", "창문이나 문을 열거나 새로 개구부를 만들어 밖을 향해 열려있는 곳이 많도록 한다.", "자연적인 공기 흐름을 방해하는 장비나 칸막이를 옮기거나 제거한다.", "더운 공기가 잘 나갈 수 있도록 창문이나 개구부를 높은 위치에 만든다."] },
                { id: 78, text: "사람들에게 건강하고 쾌적한 실내공기를 제공하기 위해서는 공기조절시스템(air-conditioning system)을 사용하라.", ideas: ["냉난방 공간의 요구에 맞는 적절한 시스템을 선정한다.", "작업장의 사람들이 편안함을 느끼는 온도에 맞춰 시스템을 조정한다.", "매우 차갑거나 불쾌한 냉풍을 피하도록 바람의 방향을 수정한다.", "이동식 국소냉방기 같은 장치 사용을 고려한다."] },
                { id: 79, text: "작업장의 좋은 공기질을 확보하기 위해 환기장치를 개선하고 잘 유지관리하라.", ideas: ["작업장 전체를 효과적으로 환기할 수 있는 시스템을 선정한다.", "환기장치의 유입구와 배출구를 가장 효과적인 곳에 설치한다.", "미는 타입(push)과 당기는 타입(pull)의 환기장치를 잘 결합하여 사용한다.", "공기 흐름이 근로자 쪽에서 오염원/열원 쪽으로 가도록 한다."] },
                { id: 80, text: "사무작업 공간은 쾌적하고 업무능률을 높일 수 있게 모든 것이 잘 정돈되도록 하라.", ideas: ["불필요한 서류, 물건을 멀리 보관하거나 버린다.", "사용한 공구는 공구상자나 공구함에 보관한다.", "케이블을 단정하게 정돈하고 케이블 관리 설비에 넣는다.", "회의탁자 등에는 중앙에 통합된 전력 및 데이터 연결설비를 사용한다."] },
                { id: 81, text: "충분한 수의 소화기를 쉽게 손 닿을 수 있는 곳에 비치하고 사람들이 소화기 사용법을 잘 알도록 하라.", ideas: ["화재 종류(A,B,C,D)에 맞는 적절한 휴대용 소화기를 선정한다.", "소화기가 있는 곳에 분명하게 표시한다.", "작업장 내에 충분한 수량의 소화기를 약 20m 간격으로 둔다.", "근로자들에게 올바른 소화기 사용법을 훈련시킨다."] },
                { id: 82, text: "자원을 보다 잘 활용하고 환경을 보호하기 위해 폐기물을 재활용해라.", ideas: ["다른 종류의 사업장 폐기물을 각각 따로 분리하여 수집한다.", "날카로운 유리조각 등 위험한 폐기물은 특별한 내구성 있는 통과 경고표지를 사용한다.", "수집된 폐기물의 재사용 또는 재활용 시스템을 확립한다.", "사용한 물을 재활용한다."] },
                { id: 83, text: "대피로는 표시를 하고 장애물이 없게 깨끗이 유지하라.", ideas: ["각 작업장마다 최소 2개 이상의 탈출로가 있도록 한다.", "대피로를 바닥에 표시하고 비상구에 분명하게 표시한다.", "대피로에는 일체 아무것도 두지 않고 항상 장애물이 없도록 한다.", "비상구 주변 공간을 깨끗이 유지하고 접근이 쉽도록 한다."] },
                { id: 84, text: "작업장소에서 안전하고 빨리 대피할 수 있도록 대피계획을 수립하라.", ideas: ["모든 사업장은 대피계획을 수립하고 대피로를 지정하며 모든 근로자에게 알려야 한다.", "대피방향을 알리는 표준화된 표지를 잘 보이는 곳에 붙여 놓는다.", "정기적으로 대피훈련을 실시한다.", "비상시 연락할 전화번호와 책임자 이름을 붙여 놓는다."] }
            ]
        },
        {
            category: "유해위험물질",
            checkpoints: [
                { id: 85, text: "소음유발 기계나 소음 부위를 격리시키거나 덮개를 설치하라.", ideas: ["높은 수준의 소음을 발생시키는 기계 전체 또는 소음이 강한 부분을 밀폐한다.", "소음이 많은 기계를 작업장 밖에 내놓고 적당한 것으로 덮는다.", "소음이 많은 기계를 대다수 근로자가 일하는 장소에서 멀리 떨어진 곳에 둔다.", "차폐막이나 칸막이를 사용하거나, 밀폐된 조작실을 제공한다."] },
                { id: 86, text: "소음을 줄이기 위해 기계나 공구를 정기적으로 유지보수해라.", ideas: ["소음을 줄일 수 있도록 공구와 기계를 정기적으로 유지보수한다.", "진동으로 인해 소음이 발생하는 부품이나 덮개를 꽉 조여준다.", "금속 부품을 플라스틱, 고무 등 방음처리 된 재료로 교체한다.", "천장이나 벽을 소음흡수 재료로 덮는다."] },
                { id: 87, text: "소음이 음성신호나 의사소통을 방해하지 않도록 하라.", ideas: ["소음을 줄여 대화가 쉽고 안전이 보장되도록 한다.", "보다 높은 수준의 경고신호를 사용하고 경광등을 추가로 사용한다.", "대화가 중요한 작업장에서는 방음된 부스나 칸막이를 사용한다.", "전화장치 주변에 칸막이를 제공한다."] },
                { id: 88, text: "근로자의 안전, 건강, 작업능률 등을 높일 수 있도록 근로자에게 영향을 주는 진동을 감소시켜라.", ideas: ["손잡이가 진동과 단절된 장비를 구입한다.", "기존 공구 손잡이를 진동방지 발포고무로 싸고, 진동흡수 장갑을 지급한다.", "유지관리를 잘 하여 공구, 기계, 차량 등의 진동을 줄인다.", "전신진동을 줄이기 위해 보다 나은 좌석 서스펜션, 쿠션 등을 사용한다."] },
                { id: 89, text: "손에 쥐고 작업하는 전기용 장비는 전기쇼크와 열에 대해 절연피복을 잘 입힌 것을 선택하라.", ideas: ["잘 피복되고 구조가 안정되며, 케이블이 절연재로 된 장비를 선정한다.", "매 사용 전에 변압기에서 낮은 전압으로 낮추어 안전하게 되어 있는지 확인한다.", "보호프레임이 제자리에 안전하게 있는지 확인한다.", "휴대용 전기 장비를 정기적으로 점검한다."] },
                { id: 90, text: "장비와 조명기구는 안전하게 전선 연결이 되도록 하라.", ideas: ["전기단자는 피복을 하거나 보호조치를 한다.", "벽에 충분한 수량의 콘센트를 만들어 케이블 접촉 위험을 최소화한다.", "정격의 소켓을 사용하고 비정격 배선은 제거한다.", "낡아서 닳은 케이블은 즉시 교체한다."] },
                { id: 91, text: "유해위험 화학물질의 용기는 경고표시가 잘 보이고, 안전취급을 확보할 수 있도록 적절하게 부착하여 보관하라.", ideas: ["모든 유해화학물질 용기에 사용자들이 이해할 수 있는 신호와 경고를 붙인다.", "표지에는 제품 이름, 성분, 사용법, 주의사항, 독성정보, 응급조치 방법 등을 담는다.", "표지와 신호는 근로자들이 선호하는 언어로 되어 있어야 한다.", "유해화학물질 용기를 정기적으로 점검하여 제대로 표지가 붙어있는지 확인한다."] },
                { id: 92, text: "근로자들이 안전하고 능률적으로 작업할 수 있도록 화학물질의 위험으로부터 보호하라.", ideas: ["가능하다면 유해위험성이 덜한 화학물질을 사용한다.", "모든 유해화학물질 용기마다 표지를 붙인다.", "안전취급을 위한 훈련을 실시한다.", "유해화학물질 근원을 밀폐하거나 작업장을 멀리 떨어지게 한다."] },
                { id: 93, text: "출입허락을 받아야 하는 좁고 사방이 막힌 공간을 확정하여 그 장소에서 출입과 작업이 안전하게 이루어 지도록 적절한 통제수단을 강구하라.", ideas: ["출입허가를 요하는 밀폐공간을 확인하고 전문가가 위험요인을 평가하도록 한다.", "들어가기 전에 산소농도, 유독물질, 폭발성 물질 존재 여부를 모니터한다.", "공기를 공급하는 호흡보호구나 기타 보호구를 착용한 근로자만 출입을 허가한다.", "밀폐공간 내부에서는 지정된 보호장비를 착용한다."] },
                { id: 94, text: "생물학적 인자에 대한 노출을 최소화하고 오염 가능성이 있는 장소를 격리시켜 생물학적 유해인자로 부터 근로자를 보호하라.", ideas: ["생물학적 위험이 있는 업무 종사자는 노출통제계획 하에 작업하도록 한다.", "노출 가능성이 있는 근로자가 사용할 수 있는 세면시설을 제공한다.", "오염된 물질이나 공구를 담을 수 있는 안전한 용기를 제공하고 생물학적 위험 표지를 붙인다.", "필요시 위생장갑, 보호의, 마스크, 보안경을 착용한다."] }
            ]
        },
        {
            category: "복지시설",
            checkpoints: [
                { id: 95, text: "위생과 청결을 위해 탈의시설, 세면장, 위생설비를 제공하고 잘 유지관리해라.", ideas: ["기존 시설의 증설, 위치 변경 등 개선계획을 세운다.", "법규상의 최소 수준(예: 15명당 1개 세면대 등)을 준수한다.", "필요시 탈의실, 옷장, 샤워시설을 제공한다.", "시설을 깨끗이 청소하고 유지관리하는 현실적인 조치를 세운다."] },
                { id: 96, text: "좋은 업무 성과와 근로자의 복지를 위해 음수시설과 위생적으로 식사할 수 있는 장소를 제공하라.", ideas: ["근로자들이 쉽게 접근할 수 있는 곳에 수도꼭지나 마시는 물 시설을 제공한다.", "작업장소에서 멀리 떨어진 편안한 분위기에서 음식을 먹을 수 있는 장소를 제공한다.", "시설은 모두 위생적인 상태를 유지하여야 한다.", "모유수유를 하는 여성을 위해 깨끗하고 조용한 별도 장소를 제공한다."] },
                { id: 97, text: "피로회복을 위해 휴게시설을 제공하라.", ideas: ["작업구역에서 분리되어 있고 방해받지 않는 휴게코너 또는 휴게실을 제공한다.", "안락한 집기와 기분전환을 할 수 있는 분위기를 만들어 준다.", "휴게시설 가까이 위생적인 화장실과 세면시설을 제공한다.", "휴게코너나 시설 주변에 나무나 꽃을 심는다."] },
                { id: 98, text: "작업장에 쉽게 접근할 수 있는 응급처치장비와 1차 의료시설을 제공하라.", ideas: ["작업장 가까운 곳에 구급상자를 제공하고 분명히 표시한다.", "구급상자에는 깨끗하고 적절한 물품들을 넣어두고, 훈련받은 구급요원 명단을 붙인다.", "책임자를 지정하여 정기적으로 구급상자 내용을 점검하고 보충하게 한다.", "1차 진료시설을 설치하거나, 인근 의료기관과 협력체계를 구축한다."] },
                { id: 99, text: "근로자들이 회의나 훈련을 받을 수 있는 장소를 제공하라.", ideas: ["집중을 방해하지 않고 소음수준이 낮은 곳을 선택한다.", "충분한 집기와 공간을 확보하여 쾌적하게 느낄 수 있어야 한다.", "적절한 환기와 조명을 제공한다.", "회의와 훈련을 우선순위에 두어 장소 사용을 통제한다."] },
                { id: 100, text: "개인보호구 사용이 필요한 장소에는 그러한 표시를 분명히 하라.", ideas: ["개인보호구 사용이 필요한 장소를 확인한다.", "해당 장소에서 필요한 개인보호구의 모양을 나타내는 사진/그림과 사용 강조 표지를 붙인다.", "지정된 지역에서 해당 개인보호구를 올바르게 사용하고 있는지 감독한다.", "안전감독팀이 정기적으로 점검하도록 한다."] },
                { id: 101, text: "근로자를 적절히 보호할 수 있는 개인보호구를 제공하라.", ideas: ["각 작업장에 존재하는 유해위험의 형태를 파악한다.", "각 사업장별 유해위험에 맞는 올바른 장비를 갖춘다.", "충분한 수량의 개인보호구를 제공한다.", "올바른 개인보호구를 적정하게 사용하고 있는지 점검한다."] },
                { id: 102, text: "적절한 설명, 착용시험, 훈련 등을 통해 개인보호구를 규칙에 맞게 사용하도록 하라.", ideas: ["보호구 사용의 필요성, 시기, 장소, 방법, 관리법 등을 알려준다.", "올바른 사용법과 유지관리에 대해 충분히 훈련시킨다.", "감독 하에 착용실험기간을 두어 적응하도록 한다.", "사용과 관리에 대해 정기적으로 감독하고 점검한다."] },
                { id: 103, text: "필요한 장소에서는 누구나 개인보호구를 사용하도록 하라.", ideas: ["작업환경의 유해위험요인과 필요한 보호방법에 대해 훈련시킨다.", "보호구를 사용하지 않으면 어떤 위험이 있는지 상기시킨다.", "올바르게 사용하는 데 대해 격려하고, 사용하지 않으면 벌칙을 가한다.", "안전조사팀을 구성하여 정기적으로 점검한다."] },
                { id: 104, text: "개인보호구에 대해 근로자들이 만족하고 있는지, 또 청결하고 잘 유지관리되고 있는지 확인하라.", ideas: ["형식과 크기가 각 근로자에게 맞는 것을 제공한다.", "가볍고, 환기기능이 있으며, 보호효과가 최대한인 쾌적한 보호구를 선정한다.", "보호구 유지관리 책임자를 지명한다.", "보호구 유지관리가 가능하도록 여분의 부품을 준비해 놓는다."] },
                { id: 105, text: "개인보호구의 적절한 보관장소를 제공하라.", ideas: ["필요한 보호구의 수량, 크기, 질을 검사하고 보관 방침을 정한다.", "보호구와 부품에 대해 기록을 유지관리한다.", "사용자들과 협의하여 각 보호구를 보관할 적절한 장소를 지정한다.", "보호구 보관소는 순서대로 배열한다."] }
            ]
        },
        {
            category: "작업조직",
            checkpoints: [
                { id: 106, text: "근로자들의 집단에 참여함으로써 날마다 작업관련 문제점들을 해결하고 넘어가라.", ideas: ["생산 및 안전 문제에 대해 근로자들과 상의하고 그룹토의를 조직한다.", "소그룹을 만들어 문제해결을 위한 실행 가능한 대안을 제시하도록 한다.", "전문적인 조언이 필요하면 그룹토의에 적절한 지원을 한다.", "제시된 제안과 실행 결과를 모든 근로자에게 알려준다."] },
                { id: 107, text: "근로시간 배치를 개선하는데 대해 근로자들과 상의하라.", ideas: ["그룹토의를 통해 새로운 근로시간 배치의 가능한 대안을 확인한다.", "시작/종료시간 변경, 시차출근, 휴식시간, 탄력근무제 등 여러 방법을 고려한다.", "기업의 요구와 근로자 선호를 함께 수용할 수 있는 방안을 찾는다.", "새로운 근로시간 배치를 시험적용하거나 도입하기 전에 근로자 의견을 듣는다."] },
                { id: 108, text: "작업대 설계 개선에 근로자를 관여시켜라.", ideas: ["근로자들에게 작업대에서 발생하는 문제와 해결에 대한 의견을 듣는다.", "현장에서 실행된 좋은 사례를 지침자료로 활용한다.", "근로자들의 제안들을 즉시 논의한다.", "작업대 개선에 대해 제안한 사람들의 신념을 인정하고 포상한다."] },
                { id: 109, text: "안전성, 용이성, 능률성을 높이기 위해 생산 변경이나 개선이 필요한 때에는 근로자들과 상의하라.", ideas: ["현재 직무 중 어렵거나 위험한 부분과 해결책에 대해 근로자들에게 물어본다.", "근로자들이 자발적으로 아이디어를 내놓을 수 있는 개방적 분위기를 만든다.", "제품디자인이나 작업공정 변경 시 근로자들에게 그 이유를 설명한다.", "개선 아이디어를 제출하는 근로자들에게 격려와 시상을 한다."] },
                { id: 110, text: "근로자들의 작업결과에 대해 정보를 제공하고 보상을 지급하라.", ideas: ["일을 잘 했을 때는 구체적으로 무엇을 잘했는지 말해주며 감사함을 표현한다.", "일을 잘 하지 못했을 때는 강점을 인정하면서 무엇을 잘못했는지, 어떻게 바로잡을지 말해준다.", "정기적으로 일의 결과에 대해 알려준다.", "회사의 전체 방침에 맞는 적절한 수단으로 근로자에게 포상을 지급한다."] },
                { id: 111, text: "근로자들에게 책임을 지는 훈련을 시키고, 그들의 업무를 개선할 수 있는 수단을 부여하라.", ideas: ["직무개선에 대한 그룹토의를 개최한다.", "직무개선과 경력개발에 관한 훈련시간에 작업조직과 직무내용 토론을 포함한다.", "그룹 업무를 촉진하여 책임이 큰 직무의 이점을 느끼게 한다.", "다수의 기술과 책임이 따르는 직무를 맡을 수 있도록 좋은 훈련기회를 제공한다."] },
                { id: 112, text: "근로자들에게 안전하고 능률적으로 작업할 수 있도록 훈련시켜라.", ideas: ["모든 근로자를 위한 훈련프로그램을 수립한다.", "기계/장비 제조업체에서 제공된 정보를 훈련에 이용한다.", "숙달된 근로자가 훈련에 참여하여 시연을 보이도록 한다.", "사진, 비디오, 시연 등 좋은 사례를 모델로 활용한다."] },
                { id: 113, text: "컴퓨터를 이용하여 근로자들에게 최신 교육프로그램을 제공하라.", ideas: ["모든 컴퓨터 작업 근로자에게 시스템의 목적, 기능, 사용법 등에 대한 기초 훈련을 제공한다.", "개인의 필요도에 따라 향상훈련을 제공한다.", "훈련 수요를 조사하고 훈련계획을 수립하여 정기적으로 갱신한다."] },
                { id: 114, text: "작업장에서 근로자들이 의사소통을 원활히 하고 서로 상부상조하도록 하라.", ideas: ["근로자들이 때때로 의사소통할 기회를 가질 수 있도록 작업절차를 마련한다.", "매 교대조별 업무 시작 전에 간단한 회합을 갖는다.", "개인별 대신 그룹별로 업무를 부여하여 그룹별 계획과 실행을 장려한다.", "일상 업무 속에 훈련과 재훈련 기회를 제공한다."] },
                { id: 115, text: "근로자들에게 업무를 배정할 때 그들의 능력과 선호도를 고려하고, 새로운 기술을 배울 수 있는 기회를 제공하라.", ideas: ["각 근로자들의 기술과 선호도를 알고 직무에 대해 상의한다.", "직무는 책임 소재가 분명하고 기술 발전에 도움이 되도록 설계한다.", "각 근로자가 흥미로운 일련의 과업에 책임을 질 수 있도록 직무를 조합한다.", "직무배치를 개선하기 위한 훈련과 재훈련을 제공한다."] },
                { id: 116, text: "함께 작업하고 그 결과에 대한 책임을 함께 지는 작업반을 구성하라.", ideas: ["일련의 작업을 계획하고 실행하는 책임을 그룹에 배당한다.", "경직된 컨베이어라인을 그룹 작업대로 대체한다.", "근로자들을 다수의 기술을 익히도록 훈련하여 직무 교환 및 분담이 가능하게 한다.", "그룹 전체의 실적에 따라서도 확실한 보상을 실시한다."] },
                { id: 117, text: "근로자들이 어려워하고 싫어하는 작업은 장기적인 측면에서 생산성을 높이기 위해 업무를 개선하라.", ideas: ["어렵다고 생각되는 직무들을 검토하고 기계화한다.", "장비와 직무수행 순서를 개선하여 직무가 쉬워지고 책임이 많아지도록 한다.", "직무를 결합하여 작업 주기를 길어지게 한다.", "검사, 유지관리 등 보다 책임 있는 일을 덧붙여 하게 한다."] },
                { id: 118, text: "작업이 보다 흥미롭고 다양해지도록 업무를 통합하라.", ideas: ["두 개 이상의 일을 결합하여 한 명의 근로자가 하도록 한다.", "일련의 업무를 결합하여 근로자당 업무 사이클이 길어지게 한다.", "직무순환을 실시하여 각 근로자의 직무에 잦은 변화가 오도록 한다.", "자율적인 작업그룹을 구성하여 결합된 직무를 수행하고 공동 책임을 지도록 한다."] },
                { id: 119, text: "다른 작업대 사이에 미완성품인 소량의 완충재고(buffer stock)를 두어라.", ideas: ["작업대 사이에 소량의 완충재고가 있도록 작업 흐름을 재조정한다.", "완충재고를 둘 자리를 마련하고, 크기/형태/수량을 고려한다.", "완충재고품이 작으면 통이나 팔레트를 사용한다.", "크고 무거우면 특별한 랙이나 이동식 선반을 사용한다."] },
                { id: 120, text: "매일 행해지는 청소와 시설관리 책임을 부과하라.", ideas: ["작업장 청결관리는 회사의 기본 방침임을 명확히 알린다.", "각 작업장소별로 청소책임을 맡을 일단의 근로자들과 책임자를 지정한다.", "각 그룹이 정기적으로 점검하고 청결관리 상태를 평가하게 한다.", "각 그룹 대표들과 그들의 노력을 어떻게 도와줄지 상의한다."] },
                { id: 121, text: "지속적으로 하는 정밀작업이나 컴퓨터작업은 생산성을 높이고 피로를 줄이기 위해 짧은 휴식을 자주 취하게 하라.", ideas: ["반복적인 작업을 대화형식의 업무와 결합한다.", "정밀/컴퓨터 작업과 비-컴퓨터 작업을 함께 수행할 수 있게 직무순환을 실시한다.", "한 시간에 한 번씩 자주 짧은 휴식을 준다.", "휴식은 작업대를 떠나서 취하도록 한다."] },
                { id: 122, text: "근로자들에게 가볍게 운동을 할 수 있는 기회를 제공하라.", ideas: ["작업 전 또는 작업 중 체조를 할 것을 장려한다.", "짧은 휴식 시간에 체조를 하도록 권유한다.", "작업 부담에 균형을 맞춰줄 수 있는 체조를 선택한다.", "체력단련시설을 제공하거나 스포츠 활동을 장려한다."] },
                { id: 123, text: "남녀 근로자들이 업무를 개선할 것을 찾아내고 이를 실행에 옮기는데 적극 참여하도록 장려하라.", ideas: ["여성근로자의 작업설계에 적극 참여를 권장한다.", "남녀 근로자가 동등한 입장에서 의견을 반영할 기회를 마련한다.", "성별에 관계없이 동등한 기회를 부여하는 교육을 실시한다.", "성별 차별대우와 성희롱 예방을 위한 경영방침과 훈련을 도입한다."] },
                { id: 124, text: "이주노동자들이 업무를 안전하고 능률적으로 할 수 있게 도움을 주라.", ideas: ["이주노동자들의 구체적인 필요사항(언어, 문화, 기술 등)을 파악하고 충족 계획을 수립한다.", "안전관련 심볼, 표지, 설명서 등을 그들의 언어로 설명하고 추가한다.", "안전보건 및 인간공학에 관한 훈련을 그들의 언어로 실시한다.", "내국인 근로자들과의 의사소통 통로를 형성하도록 돕는다."] },
                { id: 125, text: "젊은 근로자들에게 적정한 양의 업무를 부여하고, 협동정신을 조장하며, 적절한 훈련을 제공하라.", ideas: ["신규 배치 시 적절한 훈련 및 지원 수단을 제공한다.", "서서히 경험을 쌓을 수 있도록 적절한 양의 업무를 배정한다.", "나이든 근로자들에게 젊은 근로자들을 지원하도록 책임을 부여한다.", "유연 근무제를 이용하여 학업을 계속할 수 있도록 한다."] },
                { id: 126, text: "장애 근로자들이 업무를 안전하고 능률적으로 수행할 수 있게 시설이나 장비를 그들에게 맞게 조정하라.", ideas: ["장애 근로자들의 특별한 요구사항을 충족할 방안에 대해 집단토의를 개최한다.", "이 매뉴얼을 이용하여 다각적인 측면을 검토한다.", "접근성, 이동성, 전체적인 지시사항, 복지시설 등을 고려한다.", "장애 근로자들의 필요성을 충족시키기 위한 훈련을 실시한다."] },
                { id: 127, text: "임신했거나 육아중인 여성근로자에게는 그들의 안전과 건강에 대해 적절한 주의을 기울여라.", ideas: ["임신한 여성은 무거운 물건을 다루는 작업에 배치해서는 안 된다.", "임신한 여성은 야간작업이나 기타 힘든 작업에 배치해서는 안 된다.", "쉽고 편하게 움직일 수 있도록 충분한 공간을 확보한다.", "앉을 수 있는 설비를 제공하고, 오랫동안 같은 자세로 있는 작업을 피한다."] },
                { id: 128, text: "노령 근로자들이 안전하고 능률적으로 작업할 수 있도록 조치를 취하라.", ideas: ["어떤 업무가 어렵거나 안전하지 않은지 검토하고 개선 방안을 논의한다.", "육체적으로 힘든 업무에는 기계장치를 사용한다.", "설명서, 표지 등을 쉽게 알아볼 수 있게 만든다.", "나이든 근로자들이 감당할 수 있게 일의 속도를 다양하게 한다."] },
                { id: 129, text: "사용자 중심의 작업장을 근로자 중심의 환경과 선호에 맞게 조정하라.", ideas: ["작업조직을 시행하기 전에 수용가능성을 평가한다.", "신기술 도입 시 근로자들에게 훈련을 실시하고 이해도를 검증한다.", "문자로 된 모든 정보에 대한 이해도를 평가하고, 근로자들이 이해하는 언어로 작성한다.", "복지시설, 기도 및 종교의식을 위한 시설 필요성에 대해 상의한다."] },
                { id: 130, text: "사업장 안전보건관리시스템의 일부로서 인간공학 관련 유해위험을 평가하는 때에는 관리자와 근로자가 함께 참여하라.", ideas: ["안전보건관리시스템에서 인간공학 관련 유해위험요소에 세심한 주의를 기울인다.", "관리자와 근로자들이 행동체크리스트를 사용하도록 권장한다.", "작업환경과 작업조직에 대해 근로자 의견을 듣는다.", "Plan-Do-Check-Act 사이클을 따른다."] },
                { id: 131, text: "정확한 비상사태 조치, 관련 시설에의 용이한 접근, 신속한 대피 등을 위해 비상사태계획을 수립하라.", ideas: ["잠재적인 비상사태의 성질을 추측하고 각 형태별 대응 행동을 정한다.", "각 비상사태 시 우선적으로 취할 행동을 정한다.", "비상사태 시 취할 행동과 대피절차를 모든 사람에게 알리고 훈련한다.", "관련 전화번호를 붙여놓고 구급설비 등을 확인한다."] },
                { id: 132, text: "우리 사업장이나 다른 사업장에서 있었던 좋은 사례로부터 우리 사업장을 개선하는 방안을 배우고 공유하라.", ideas: ["사업장 내 개선 사례 목록을 만든다.", "다른 사업장을 방문하거나 안내책자를 보고 좋은 사례에서 배운다.", "여러 근로자로 그룹을 구성하여 가능한 개선에 대해 논의한다.", "좋은 사례로부터 배우면서 실행 가능한 해결방안을 찾아본다."] }
            ]
        }
    ];
    // CHECKLIST_DATA_END
    let currentIndustry = '';
    let currentJobType = '';

    document.addEventListener('DOMContentLoaded', function() {
        const checklistBody = document.getElementById('checklist-body');
        const categoryButtonsContainer = document.getElementById('category-buttons');
        const checkboxMap = new Map();
        
        function renderChecklist(data) {
            checklistBody.innerHTML = '';
            categoryButtonsContainer.innerHTML = '';
            checkboxMap.clear();
            let globalIdCounter = 1;

            data.forEach(category => {
                const categoryId = category.category.replace(/\s+/g, '-');
                
                const catButton = document.createElement('a');
                catButton.href = `#${categoryId}`;
                catButton.textContent = category.category;
                categoryButtonsContainer.appendChild(catButton);
                
                const headerRow = document.createElement('tr');
                headerRow.innerHTML = `<td colspan="4" id="${categoryId}" class="category-header">${category.category}</td>`;
                checklistBody.appendChild(headerRow);
                
                const columnHeaderRow = document.createElement('tr');
                columnHeaderRow.className = 'column-header';
                columnHeaderRow.innerHTML = `
                    <th class="center" style="width: 5%;">연번</th>
                    <th style="width: 50%;">인간공학 체크포인트</th>
                    <th class="center" style="width: 20%;">구체적인 사항</th>
                    <th class="center" style="width: 15%;">조치여부</th>
                `;
                checklistBody.appendChild(columnHeaderRow);

                category.checkpoints.forEach(item => {
                    const row = document.createElement('tr');
                    row.className = "checklist-item";
                    row.setAttribute('data-id', item.id);
                    row.innerHTML = `
                        <td class="center">${globalIdCounter}</td>
                        <td>${item.text}</td>
                        <td class="center">
                            <button class="btn btn-secondary" data-id="${item.id}">보기</button>
                        </td>
                        <td class="center">
                            <label class="switch">
                                <input type="checkbox" data-id="${item.id}">
                                <span class="slider"></span>
                            </label>
                        </td>
                    `;
                    checklistBody.appendChild(row);
                    checkboxMap.set(item.id, row.querySelector('input[type="checkbox"]'));
                    globalIdCounter++;
                });

                const topButtonRow = document.createElement('tr');
                topButtonRow.innerHTML = `<td colspan="4" style="text-align: right; padding: 10px;"><a href="#category-nav" class="to-top-btn">맨 위로</a></td>`;
                checklistBody.appendChild(topButtonRow);
            });
        }
        
        // Initial Render
        renderChecklist(checklistData);
        
        // --- Modal Functionality ---
        const ideaModal = document.getElementById('ideaModal');
        const closeModalBtn = document.getElementById('closeModal');
        const okModalBtn = document.getElementById('okModal');
        const modalCheckpoint = document.getElementById('modal-checkpoint');
        const modalIdeas = document.getElementById('modal-ideas');

        const manualModal = document.getElementById('manualModal');
        const manualBtn = document.getElementById('manual-btn');
        const closeManualModalBtn = document.getElementById('closeManualModal');
        const okManualModalBtn = document.getElementById('okManualModal');

        function openManualModal() {
            if (manualModal) manualModal.style.display = 'block';
        }
        function closeManualModal() {
            if (manualModal) manualModal.style.display = 'none';
        }

        if (manualBtn) manualBtn.addEventListener('click', () => {
            openManualModal();
            // 메뉴 드롭다운이 열려있다면 닫아줍니다.
            if (actionDropdown.classList.contains('show')) {
                actionDropdown.classList.remove('show');
            }
        });
        if (closeManualModalBtn) closeManualModalBtn.addEventListener('click', closeManualModal);
        if (okManualModalBtn) okManualModalBtn.addEventListener('click', closeManualModal);
        if (manualModal) manualModal.addEventListener('click', function(e) {
            // 모달 바깥의 어두운 영역을 클릭하면 닫히도록 함
            if (e.target === manualModal) {
                closeManualModal();
            }
        });

        function findCheckpointById(id) {
            for (const category of checklistData) {
                const found = category.checkpoints.find(cp => cp.id === id);
                if (found) return found;
            }
            // Fallback for worker report which might have original_id from a different dataset
             for (const category of originalChecklistData) {
                const found = category.checkpoints.find(cp => cp.id === id);
                if (found) return found;
            }
            return null;
        }

        checklistBody.addEventListener('click', function(e) {
            if (e.target && e.target.tagName === 'BUTTON' && e.target.closest('td').cellIndex === 2) { // check if it's the '보기' button
                const checkpointId = parseInt(e.target.getAttribute('data-id'));
                const checkpoint = findCheckpointById(checkpointId);
                if (checkpoint) {
                    modalCheckpoint.textContent = `${checkpoint.id}. ${checkpoint.text}`;
                    modalIdeas.innerHTML = '';
                    checkpoint.ideas.forEach(idea => {
                        const li = document.createElement('li');
                        li.textContent = idea;
                        modalIdeas.appendChild(li);
                    });
                    ideaModal.style.display = 'block';
                }
            }
        });

        function closeIdeaModal() {
            ideaModal.style.display = 'none';
        }

        closeModalBtn.addEventListener('click', closeIdeaModal);
        okModalBtn.addEventListener('click', closeIdeaModal);
        ideaModal.addEventListener('click', function(e) {
            if (e.target === ideaModal) {
                closeIdeaModal();
            }
        });

        // --- Dropdown Menu Functionality ---
        const menuToggleBtn = document.getElementById('menu-toggle-btn');
        const actionDropdown = document.getElementById('action-dropdown');

        menuToggleBtn.addEventListener('click', function(event) {
            event.stopPropagation();
            actionDropdown.classList.toggle('show');
        });

        window.addEventListener('click', function(event) {
            if (!menuToggleBtn.contains(event.target) && !actionDropdown.contains(event.target)) {
                if (actionDropdown.classList.contains('show')) {
                    actionDropdown.classList.remove('show');
                }
            }
        });


        // --- Save/Load/Generate Functionality ---
        const loadBtn = document.getElementById('load-btn');
        const saveBtn = document.getElementById('save-btn');
        const fileInput = document.getElementById('csv-file-input');

        saveBtn.addEventListener('click', () => {
            let csvContent = "data:text/csv;charset=utf-8,\uFEFF"; // BOM for Excel
            csvContent += "ID,Checkpoint,ActionTaken\n";

            checklistData.forEach(category => {
                category.checkpoints.forEach(item => {
                    const checkbox = checkboxMap.get(item.id);
                    const isChecked = checkbox ? checkbox.checked : false;
                    const row = `${item.id},"${item.text.replace(/"/g, '""')}",${isChecked}`;
                    csvContent += row + "\n";
                });
            });

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            
            const now = new Date();
            const date = now.toISOString().split('T')[0];
            const time = now.toTimeString().split(' ')[0].replace(/:/g, '-');
            link.setAttribute("download", `ergonomic_checkpoint_${date}_${time}.csv`);
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });

        loadBtn.addEventListener('click', () => {
            fileInput.click();
        });

        fileInput.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (!file) {
                return;
            }
            const reader = new FileReader();
            reader.onload = function(e) {
                const text = e.target.result;
                const rows = text.split('\n').slice(1); // Skip header
                rows.forEach(rowStr => {
                    if (rowStr.trim() === '') return;
                    
                    const parts = rowStr.match(/(?:"[^"]*"|[^,]+)/g);
                    if(parts && parts.length >= 3){
                        const id = parseInt(parts[0], 10);
                        const isChecked = parts[parts.length - 1].trim().toLowerCase() === 'true';

                        const checkbox = checkboxMap.get(id);
                        if (checkbox) {
                            checkbox.checked = isChecked;
                        }
                    }
                });
            };
            reader.readAsText(file, "UTF-8");
            fileInput.value = '';
        });
    
    // --- REPORT GENERATION LOGIC ---
    const generateBtn = document.getElementById('generate-btn');
    const selectionReportModal = document.getElementById('selectionReportModal');
    const closeSelectionReportModalBtn = document.getElementById('closeSelectionReportModal');
    const cancelSelectionReportBtn = document.getElementById('cancelSelectionReportBtn');
    const reportModal = document.getElementById('reportModal');
    const reportTitle = document.getElementById('report-title');
    const reportContent = document.getElementById('report-modal-content');
    const closeReportModalBtn = document.getElementById('closeReportModal');
    const closeReportBtn = document.getElementById('closeReportBtn');
    const printReportBtn = document.getElementById('printReportBtn');
    const reportGenLoading = document.getElementById('report-gen-loading');
    const reportGenError = document.getElementById('report-gen-error');

    // Report Type Selection Buttons
    const generateWorkerReportBtn = document.getElementById('generateWorkerReportBtn');
    const generateManagerReportBtn = document.getElementById('generateManagerReportBtn');
    const generateExpertReportBtn = document.getElementById('generateExpertReportBtn');

    function openSelectionModal() {
        reportGenError.textContent = '';
        reportGenLoading.style.display = 'none';
        selectionReportModal.style.display = 'block';
    }
    function closeSelectionModal() {
        selectionReportModal.style.display = 'none';
    }

    generateBtn.addEventListener('click', openSelectionModal);
    closeSelectionReportModalBtn.addEventListener('click', closeSelectionModal);
    cancelSelectionReportBtn.addEventListener('click', closeSelectionModal);

    // Render the final report into the report modal
    function renderGeneratedReport(data, type) {
        reportContent.innerHTML = '';
        
        // Map original item ID to its sequential number from the main expert list
        const idToSequentialNumberMap = new Map();
        let seqCounter = 1;
        checklistData.forEach(category => {
            category.checkpoints.forEach(item => {
                idToSequentialNumberMap.set(item.id, seqCounter);
                seqCounter++;
            });
        });

        let titleText = '';
        switch(type) {
            case 'worker':
                titleText = '작업자용 체크포인트 (핵심 20)';
                break;
            case 'manager':
                titleText = '관리자용 체크포인트 (범주별 50)';
                break;
            case 'expert':
            default:
                titleText = '전문가용 체크포인트 (전체)';
                break;
        }
        reportTitle.textContent = titleText;

        if (type === 'worker') {
            const table = document.createElement('table');
            table.innerHTML = `
                <thead>
                    <tr>
                        <th style="width: 10%;">번호</th>
                        <th style="width: 70%;">인간공학 체크포인트</th>
                        <th style="width: 20%;">조치여부</th>
                    </tr>
                </thead>
            `;
            const tbody = document.createElement('tbody');
            data.forEach(item => {
                const originalItemId = item.original_id || item.id;
                const originalItem = findCheckpointById(originalItemId);
                const checkbox = originalItem ? checkboxMap.get(originalItem.id) : null;
                const isChecked = checkbox ? checkbox.checked : false;
                const status = isChecked ? 'O' : 'X';
                const sequentialNumber = idToSequentialNumberMap.get(originalItemId) || '-';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${sequentialNumber}</td>
                    <td>${item.text}</td>
                    <td>${status}</td>
                `;
                tbody.appendChild(row);
            });
            table.appendChild(tbody);
            reportContent.appendChild(table);
        } else { // Manager and Expert types are categorized
            data.forEach(category => {
                if (!category.checkpoints || category.checkpoints.length === 0) return;

                const categoryHeader = document.createElement('h4');
                categoryHeader.textContent = category.category;
                reportContent.appendChild(categoryHeader);

                const table = document.createElement('table');
                table.innerHTML = `
                    <thead>
                        <tr>
                            <th style="width: 10%;">번호</th>
                            <th style="width: 70%;">인간공학 체크포인트</th>
                            <th style="width: 20%;">조치여부</th>
                        </tr>
                    </thead>
                `;
                
                const tbody = document.createElement('tbody');
                category.checkpoints.forEach(item => {
                    const checkbox = checkboxMap.get(item.id);
                    const isChecked = checkbox ? checkbox.checked : false;
                    const status = isChecked ? 'O' : 'X';
                    const sequentialNumber = idToSequentialNumberMap.get(item.id) || '-';
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${sequentialNumber}</td>
                        <td>${item.text}</td>
                        <td>${status}</td>
                    `;
                    tbody.appendChild(row);
                });
                table.appendChild(tbody);
                reportContent.appendChild(table);
            });
        }
        
        reportModal.style.display = 'block';
    }

    generateExpertReportBtn.addEventListener('click', () => {
        closeSelectionModal();
        renderGeneratedReport(checklistData, 'expert');
    });
    
    // =================================================================================
    // START: MODIFIED CODE by Gemini - Loading Message Fix
    // =================================================================================
    generateWorkerReportBtn.addEventListener('click', () => {
        if (workerChecklistData) {
            // If data is already generated, render it immediately and close the selection modal.
            closeSelectionModal();
            renderGeneratedReport(workerChecklistData, 'worker');
        } else {
            // Otherwise, call the async function which will show the loading message.
            generateReportFromDefault('worker');
        }
    });

    generateManagerReportBtn.addEventListener('click', () => {
        if (managerChecklistData) {
            // If data is already generated, render it immediately and close the selection modal.
            closeSelectionModal();
            renderGeneratedReport(managerChecklistData, 'manager');
        } else {
            // Otherwise, call the async function which will show the loading message.
            generateReportFromDefault('manager');
        }
    });
    // =================================================================================
    // END: MODIFIED CODE by Gemini
    // =================================================================================

    function closeReportModal() {
        reportModal.style.display = 'none';
    }

    closeReportModalBtn.addEventListener('click', closeReportModal);
    closeReportBtn.addEventListener('click', closeReportModal);
    
    printReportBtn.addEventListener('click', () => {
        const reportContentHTML = document.getElementById('report-modal-content').innerHTML;
        const printWindow = window.open('', '_blank', 'height=800,width=800');
        const industry = currentIndustry || '일반';
        const jobType = currentJobType || '범용';
        const title = `${industry} - ${jobType} ${reportTitle.textContent}`;

        printWindow.document.write(`<html><head><title>${title}</title>`);
        printWindow.document.write(`
            <style>
                body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
                h1 { font-size: 1.5rem; text-align: center; margin-bottom: 20px;}
                table { width: 100%; border-collapse: collapse; margin-bottom: 20px; page-break-inside: avoid; }
                th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                th { background-color: #f2f2f2; text-align: center; }
                h4 { 
                    font-size: 1.2rem;
                    font-weight: 600;
                    margin-top: 20px;
                    margin-bottom: 10px;
                    padding-bottom: 5px;
                    border-bottom: 1px solid #ddd;
                    color: #1e3a8a;
                    page-break-after: avoid;
                }
                td:first-child, td:last-child { text-align: center; }
                @media print {
                    @page { margin: 20mm; }
                    body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
                }
            </style>
        `);
        printWindow.document.write('</head><body>');
        printWindow.document.write(`<h1>${title}</h1>`);
        printWindow.document.write(reportContentHTML);
        printWindow.document.write('</body></html>');
        printWindow.document.close();
        
        setTimeout(() => {
            printWindow.focus();
            printWindow.print();
            printWindow.close();
        }, 250);
    });

// AI_SCRIPT_START

/* --- [수정 후] 진행바 헬퍼 함수 시작 --- */
// 인터벌 타이머를 저장할 변수
let progressInterval1 = null;
let progressInterval2 = null;
let progressInterval3 = null;

/**
 * 진행바를 시작하고 애니메이션을 적용하는 함수
 * @param {string} barId - 프로그레스 바 요소의 ID
 * @param {string} labelId - 레이블 요소의 ID
 * @param {number} durationInSeconds - 최대 소요 시간 (초)
 * @param {string} baseLabel - "1/3: 전문가용" 과 같은 기본 레이블
 * @returns {number} setInterval의 ID
 */
function startProgressBar(barId, labelId, durationInSeconds, baseLabel) {
    const bar = document.getElementById(barId);
    const label = document.getElementById(labelId);
    if (!bar || !label) return null;

    let startTime = Date.now();
    let durationInMs = durationInSeconds * 1000;

    const updateProgress = () => {
        let elapsedTime = Date.now() - startTime;
        let progress = (elapsedTime / durationInMs) * 100;

        if (progress >= 100) {
            progress = 99; // API가 완료될 때까지 99%에서 대기
            bar.style.width = '99%';
            label.textContent = `${baseLabel} (거의 완료...)`;
            stopProgressBar(barId); // 타이머 중지
        } else {
            bar.style.width = `${progress}%`;
            label.textContent = `${baseLabel} (${Math.round(progress)}%)`;
        }
    };

    const intervalId = setInterval(updateProgress, 250); // 0.25초마다 업데이트

    // 적절한 전역 변수에 intervalId 저장
    if (barId === 'progress-bar-1') progressInterval1 = intervalId;
    else if (barId === 'progress-bar-2') progressInterval2 = intervalId;
    else if (barId === 'progress-bar-3') progressInterval3 = intervalId;
    
    return intervalId;
}

/**
 * 특정 진행바의 타이머를 중지하는 함수
 */
function stopProgressBar(barId) {
    let intervalId = null;
    if (barId === 'progress-bar-1') {
        intervalId = progressInterval1;
        progressInterval1 = null;
    } else if (barId === 'progress-bar-2') {
        intervalId = progressInterval2;
        progressInterval2 = null;
    } else if (barId === 'progress-bar-3') {
        intervalId = progressInterval3;
        progressInterval3 = null;
    }
    
    if (intervalId) {
        clearInterval(intervalId);
    }
}

/**
 * 진행바를 100% 완료 상태로 설정하는 함수
 */
function completeProgressBar(barId, labelId, baseLabel) {
    stopProgressBar(barId); // 타이머 정지
    const bar = document.getElementById(barId);
    const label = document.getElementById(labelId);
    if (bar) bar.style.width = '100%';
    if (label) label.textContent = `${baseLabel} (100% 완료)`;
}

/**
 * 모든 진행바를 초기 상태(0%)로 리셋하고 숨기는 함수
 */
function resetProgressBars() {
    const container = document.getElementById('ai-progress-container');
    if (container) container.style.display = 'none';

    ['1', '2', '3'].forEach(num => {
        stopProgressBar(`progress-bar-${num}`); // 혹시 실행중인 타이머가 있다면 정지
        const bar = document.getElementById(`progress-bar-${num}`);
        const label = document.getElementById(`progress-label-${num}`);
        if(bar) bar.style.width = '0%';
        if(label) {
            let labelText = '';
            if (num === '1') labelText = '1/3: 전문가용 생성 대기 중...';
            else if (num === '2') labelText = '2/3: 관리자용 생성 대기 중...';
            else if (num === '3') labelText = '3/3: 작업자용 생성 대기 중...';
            label.textContent = labelText;
        }
    });
}
/* --- [수정 후] 진행바 헬퍼 함수 끝 --- */

const originalChecklistData = JSON.parse(JSON.stringify(checklistData)); 
let workerChecklistData = null;
let managerChecklistData = null;



// =========================
// ▼▼▼ n8n 연동 함수 (신규) ▼▼▼
// =========================
/**
 * n8n 워크플로우를 호출하여 3가지 유형의 체크리스트를 한 번에 받아옵니다.
 * @param {string} industry 업종
 * @param {string} jobType 작업내용
 * @returns {Promise<object|null>} { expertData, managerData, workerData } 객체 또는 실패 시 null
 */
async function callN8nWorkflow(industry, jobType) {
    // 1단계에서 생성한 n8n Webhook의 "Production URL"을 여기에 입력하세요.
    const n8nWebhookUrl = 'https://ergoman.app.n8n.cloud/webhook/fb772f5b-f2da-47a6-8c25-2f64ed5e6c88'; // ⬅️ [중요] 본인의 n8n URL로 변경
    const originalData = typeof originalChecklistData !== 'undefined' ? originalChecklistData : [];

    try {
        const response = await fetch(n8nWebhookUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                industry: industry,
                jobType: jobType,
                originalData: originalChecklistData
            })
        });

        if (!response.ok) {
            throw new Error(`n8n 서버 오류: ${response.status}`);
        }

        const result = await response.json();
        
        // n8n 워크플로우가 3가지 데이터를 모두 반환했는지 확인
        if (result.expertData && result.managerData && result.workerData) {
            return result; 
        } else {
            throw new Error("n8n 서버가 유효한 데이터를 반환하지 않았습니다.");
        }
    } catch (error) {
        console.error("n8n 워크플로우 호출 실패:", error.message);
        return null; // 오류 발생 시 null 반환
    }
}


function showNotification(message, type = 'success') {
    const notificationArea = document.getElementById('notification-area');
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.textContent = message;

    notification.addEventListener('animationend', () => {
        if (notification.classList.contains('fade-out')) {
            notification.remove();
        }
    });

    notificationArea.appendChild(notification);
    
    setTimeout(() => {
        notification.classList.add('fade-out');
    }, 3000); 
}

/**
 * Generates and triggers the download of a customized HTML file.
 * This file contains the AI-generated checklists and simplified logic for offline use.
 */
function triggerHtmlDownload(expertData, managerData, workerData, industry, jobType) {
    const cleanIndustry = industry || '일반';
    const cleanJobType = jobType || '범용';
    const filename = `${cleanIndustry}_${cleanJobType}_인간공학_체크포인트.html`;
    const title = `${cleanIndustry} - ${cleanJobType} 인간공학 체크포인트`;

    let finalHtml = document.documentElement.outerHTML;

    // 1. Update Title and Header in the saved file
    finalHtml = finalHtml.replace(/<title>.*<\/title>/, `<title>${title}</title>`);
    finalHtml = finalHtml.replace(/<header>[\s\S]*?<\/header>/s, `
        <header>
            <h1>${title}</h1>
            <p>작업장의 안전, 보건 및 작업조건 개선</p>
        </header>
    `);

    // 1.5. [추가] 생성된 HTML 파일에서 AI 매뉴얼 부분을 숨기는 CSS 주입
    // .ai-manual-only 클래스를 가진 모든 요소를 보이지 않게 처리합니다.
    const hideAiManualStyle = '\n    <style>.ai-manual-only { display: none !important; }</style>\n';
    finalHtml = finalHtml.replace('</head>', `${hideAiManualStyle}</head>`);    

    // 2. Simplify the dropdown menu for the saved file
    const simplifiedMenuHtml = `
        <div id="action-dropdown" class="dropdown-content">
            <button id="manual-btn">사용자 매뉴얼</button>
            <hr class="dropdown-divider">
            <button id="load-btn">불러오기</button>
            <button id="save-btn">저장하기</button>
            <hr class="dropdown-divider">
            <button id="generate-btn">체크포인트(인쇄용) 생성</button>
        </div>`;
    finalHtml = finalHtml.replace(/<div id="action-dropdown" class="dropdown-content[^"]*">[\s\S]*?<\/div>/s, simplifiedMenuHtml);

    // 3. Inject all three data sets (expert, manager, worker) into the script, replacing the original data block.
    // This avoids variable re-declaration errors.
const dataToInject = `
    let checklistData = ${JSON.stringify(expertData, null, 2)};
    let managerChecklistData = ${JSON.stringify(managerData, null, 2)};
    let workerChecklistData = ${JSON.stringify(workerData, null, 2)};
    `;
    finalHtml = finalHtml.replace(
        /(\/\/\s*CHECKLIST_DATA_START)[\s\S]*?(\/\/\s*CHECKLIST_DATA_END)/s,
        `$1\n${dataToInject}\n$2`
    );

    // 4. Completely remove the AI script block, as its functionality is not needed in the static file
    // and it contains variable declarations that would cause errors.
    finalHtml = finalHtml.replace(
        /(\/\/\s*AI_SCRIPT_START)[\s\S]*?(\/\/\s*AI_SCRIPT_END)/s,
        '// AI-related functions removed for static HTML file.'
    );
    
    // 5. Remove the AI config modal from the HTML body to avoid confusion
    finalHtml = finalHtml.replace(/\s*<div id="aiConfigModal"[\s\S]*<\/div>\s*<\/div>\s*<\/div>/s, '');

    // 6. Create and trigger the download
    const blob = new Blob([finalHtml], { type: 'text/html;charset=utf-8' });
    const link = document.createElement("a");
    const url = URL.createObjectURL(blob);
    link.setAttribute("href", url);
    link.setAttribute("download", filename);
    link.style.visibility = 'hidden';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    URL.revokeObjectURL(url);
}

const aiConfigModal = document.getElementById('aiConfigModal');
const openAiConfigBtn = document.getElementById('ai-config-btn');
const closeAiConfigBtn = document.getElementById('closeAiConfigModal');
const cancelAiConfigBtn = document.getElementById('cancelAiConfigBtn');
const applyAiConfigBtn = document.getElementById('applyAiConfigBtn');
const industryInput = document.getElementById('industry-input');
const jobTypeInput = document.getElementById('job-type-input');
const aiErrorMessage = document.getElementById('ai-error-message');
const aiLoadingMessage = document.getElementById('ai-loading-message');

function openAiModal() {
    currentIndustry = '';
    currentJobType = '';
    aiErrorMessage.textContent = '';
    aiLoadingMessage.textContent = '입력하신 업종과 작업내용에 적합한 설문문항 전체를 생성하기 때문에 장시간이 걸립니다. 잠시만 기다려 주세요.';
    aiLoadingMessage.style.color = 'red'; 
    aiLoadingMessage.style.display = 'none';
    industryInput.value = currentIndustry;
    jobTypeInput.value = currentJobType;

    resetProgressBars(); // [수정 후] 진행바 리셋 및 숨기기

    if (cancelAiConfigBtn) cancelAiConfigBtn.textContent = '닫기';
    if (applyAiConfigBtn) {
        applyAiConfigBtn.style.display = 'inline-flex';
        applyAiConfigBtn.querySelector('.btn-text').style.display = 'inline';
        applyAiConfigBtn.querySelector('.spinner').style.display = 'none';
        applyAiConfigBtn.disabled = false;
    }

    if(aiConfigModal) aiConfigModal.style.display = 'block';
}

function closeAiModal() {
    if(aiConfigModal) aiConfigModal.style.display = 'none';
}

if(openAiConfigBtn) openAiConfigBtn.addEventListener('click', openAiModal);
if(closeAiConfigBtn) closeAiConfigBtn.addEventListener('click', closeAiModal);
if(cancelAiConfigBtn) cancelAiConfigBtn.addEventListener('click', closeAiModal);

async function generateReportFromDefault(type) {
    reportGenError.textContent = '';
    
    const loadingTextContainer = document.getElementById('report-gen-loading');
    const loadingText = loadingTextContainer.querySelector('p');
    if (type === 'worker') {
        loadingText.textContent = '작업자용 설문지가 생성중(30초~1분 예상)입니다. 조금만 기다려 주세요.';
    } else { // manager
        loadingText.textContent = '관리자용 설문지가 생성중(1~3분 예상)입니다. 조금만 기다려 주세요.';
    }
    
    reportGenLoading.style.display = 'block';
    [generateWorkerReportBtn, generateManagerReportBtn, generateExpertReportBtn].forEach(btn => btn.disabled = true);

    let systemPrompt, userQuery, responseSchema;
    const model = 'gemini-2.5-flash-preview-05-20';
    const industry = currentIndustry || '일반';
    const jobType = currentJobType || '범용';

    if (type === 'worker') {
        systemPrompt = `당신은 산업 안전 및 인간공학 전문가입니다. 주어진 전체 체크리스트에서 일반 작업자가 쉽게 이해하고 직접 점검할 수 있는 가장 중요하고 핵심적인 항목 20개를 선정해 주십시오. 범주는 무시하고, 선정된 20개 항목을 하나의 목록으로 만들어주세요. 응답은 'text' (체크리스트 문항)와 'original_id' (원본 ID) 속성을 가진 객체들의 JSON 배열 형식이어야 합니다.`;
        userQuery = `업종: "${industry}", 직종: "${jobType}"을 고려하여, 다음 JSON 데이터에서 작업자용 핵심 체크리스트 20개를 선정해주세요:\n\n${JSON.stringify(originalChecklistData, null, 2)}`;
        responseSchema = { type: "ARRAY", items: { type: "OBJECT", properties: { original_id: { type: "NUMBER" }, text: { type: "STRING" } }, required: ["original_id", "text"] } };
    } else { // manager
        systemPrompt = `당신은 산업 안전 및 인간공학 전문가입니다. 주어진 전체 체크리스트의 각 범주(category)별로 관리자가 감독하고 개선을 지시하기에 가장 중요한 항목을 5~6개씩 선정하여, 총 50개 내외의 체크리스트를 만들어주십시오. 원래의 JSON 데이터 구조(카테고리와 그에 속한 체크포인트 목록)를 그대로 유지해야 합니다. 'id'와 'ideas' 필드는 변경하지 말고 그대로 반환해 주세요. 응답은 수정된 전체 JSON 객체여야 합니다.`;
        userQuery = `업종: "${industry}", 직종: "${jobType}"을 고려하여, 다음 JSON 데이터에서 관리자용 체크리스트를 생성해주세요:\n\n${JSON.stringify(originalChecklistData, null, 2)}`;
        responseSchema = { type: "ARRAY", items: { type: "OBJECT", properties: { category: { type: "STRING" }, checkpoints: { type: "ARRAY", items: { type: "OBJECT", properties: { id: { type: "NUMBER" }, text: { type: "STRING" }, ideas: { type: "ARRAY", items: { "type": "STRING" } } }, required: ["id", "text", "ideas"] } } }, required: ["category", "checkpoints"] } };
    }

    const payload = { contents: [{ parts: [{ text: userQuery }] }], systemInstruction: { parts: [{ text: systemPrompt }] }, generationConfig: { responseMimeType: "application/json", responseSchema: responseSchema } };
    
    const result = await callGeminiApi(payload, model);

    if (result) {
        const generatedData = JSON.parse(result.candidates[0].content.parts[0].text);
        if (type === 'worker') workerChecklistData = generatedData;
        if (type === 'manager') managerChecklistData = generatedData;
        
        closeSelectionModal(); // Close modal after data is fetched
        renderGeneratedReport(generatedData, type);
    } else {
        reportGenError.textContent = '보고서 생성 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.';
    }

    reportGenLoading.style.display = 'none';
    [generateWorkerReportBtn, generateManagerReportBtn, generateExpertReportBtn].forEach(btn => btn.disabled = false);
}


if(applyAiConfigBtn) {
    applyAiConfigBtn.addEventListener('click', async () => {
        const industry = industryInput.value.trim();
        const jobType = jobTypeInput.value.trim();

        if (!industry || !jobType) {
            aiErrorMessage.textContent = '업종과 직종을 모두 입력해주세요.';
            return;
        }
        aiErrorMessage.textContent = '';

        const btnText = applyAiConfigBtn.querySelector('.btn-text');
        const spinner = applyAiConfigBtn.querySelector('.spinner');
        
        btnText.style.display = 'none';
        spinner.style.display = 'block';
        applyAiConfigBtn.disabled = true;

        // [수정] 진행바 UI 설정
        const progressContainer = document.getElementById('ai-progress-container');
        resetProgressBars(); // 모든 바 리셋
        aiLoadingMessage.style.display = 'block'; 
        progressContainer.style.display = 'block'; // 진행바 컨테이너 보이기
        
        const model = 'gemini-2.5-flash-preview-05-20';

try {
            // --- [수정] Step 1: n8n 워크플로우 호출 (한 번에 3개 모두 요청) ---
            
            // 3개의 진행바를 모두 시작 (n8n이 전체 작업을 처리하는 시간만큼)
            // n8n이 캐시를 사용하면 매우 빠르고, 아니면 오래 걸립니다.
            // 예상 시간은 '캐시 없음(최악)'을 기준으로 넉넉하게 잡습니다.
            startProgressBar('progress-bar-1', 'progress-label-1', 480, '1/3: 전문가용 생성 중...'); // 8분
            startProgressBar('progress-bar-2', 'progress-label-2', 480, '2/3: 관리자용 생성 중...'); // 8분
            startProgressBar('progress-bar-3', 'progress-label-3', 480, '3/3: 작업자용 생성 중...'); // 8분
            
            // [수정] 2단계에서 만든 n8n 함수를 *한 번* 호출합니다.
            const result = await callN8nWorkflow(industry, jobType);

            if (!result) {
                // callN8nWorkflow 함수 내부에서 이미 오류 로그를 찍었으므로, 여기서는 에러만 발생시킴
                throw new Error('n8n 워크플로우에서 데이터를 가져오지 못했습니다.');
            }

            // [수정] n8n에서 받은 데이터를 각 변수에 할당합니다.
            const expertData = result.expertData;
            const managerData = result.managerData;
            const workerData = result.workerData;
            
            // [수정] 3개의 진행바를 모두 '완료' 처리합니다.
            completeProgressBar('progress-bar-1', 'progress-label-1', '1/3: 전문가용');
            completeProgressBar('progress-bar-2', 'progress-label-2', '2/3: 관리자용');
            completeProgressBar('progress-bar-3', 'progress-label-3', '3/3: 작업자용');
            
            // --- All successful, update UI and data ---
            progressContainer.style.display = 'none'; // 성공 시 진행바 숨기기
            aiLoadingMessage.style.display = 'block';
            aiLoadingMessage.textContent = '요청하신 업종과 작업내용에 맞춘 체크포인트가 생성되어, HTML 파일로 저장하였습니다.';
            aiLoadingMessage.style.color = '#16a34a'; 
            
            // HTML 다운로드 트리거 (이 함수는 수정할 필요 없음)
            triggerHtmlDownload(expertData, managerData, workerData, industry, jobType);

            if (cancelAiConfigBtn) cancelAiConfigBtn.textContent = '확인';
            if (applyAiConfigBtn) applyAiConfigBtn.style.display = 'none';

        } catch (error) {
            console.error("AI 생성 과정 오류:", error);
            aiErrorMessage.textContent = `오류가 발생했습니다: ${error.message}. 잠시 후 다시 시도해주세요.`;
            aiLoadingMessage.style.display = 'none';
            resetProgressBars(); // 오류 시 진행바 리셋 및 숨기기
        } finally {
            btnText.style.display = 'inline';
            spinner.style.display = 'none';
            applyAiConfigBtn.disabled = false;
        }
    });
}
// AI_SCRIPT_END
});
</script>

</body>
</html>
